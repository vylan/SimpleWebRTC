!function(e){if("function"==typeof bootstrap)bootstrap("simplewebrtc",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeSimpleWebRTC=e}else"undefined"!=typeof window?window.SimpleWebRTC=e():global.SimpleWebRTC=e()}(function(){var e;return function(e,t,n){function i(n,o){if(!t[n]){if(!e[n]){var a="function"==typeof require&&require;if(!o&&a)return a(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var c=t[n]={exports:{}};e[n][0].call(c.exports,function(t){var r=e[n][1][t];return i(r?r:t)},c,c.exports)}return t[n].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t){function n(e){this.connection=e.connection?e.connection:io.connect(e.url,e.socketio)}n.prototype.on=function(e,t){this.connection.on(e,t)},n.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)},n.prototype.getSessionid=function(){return this.connection.id},n.prototype.disconnect=function(){return this.connection.disconnect()},t.exports=n},{}],2:[function(e,t){function n(){}t.exports=n,n.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e){this.callbacks=this.callbacks||{};var t=3===arguments.length,n=t?arguments[1]:void 0,i=t?arguments[2]:arguments[1];return i._groupName=n,(this.callbacks[e]=this.callbacks[e]||[]).push(i),this},t.once=function(e){function t(){n.off(e,t),o.apply(this,arguments)}var n=this,i=3===arguments.length,r=i?arguments[1]:void 0,o=i?arguments[2]:arguments[1];return this.on(e,r,t),this},t.releaseGroup=function(e){this.callbacks=this.callbacks||{};var t,n,i,r;for(t in this.callbacks)for(r=this.callbacks[t],n=0,i=r.length;i>n;n++)r[n]._groupName===e&&(r.splice(n,1),n--,i--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,i=this.callbacks[e];return i?1===arguments.length?(delete this.callbacks[e],this):(n=i.indexOf(t),i.splice(n,1),0===i.length&&delete this.callbacks[e],this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,i,r=[].slice.call(arguments,1),o=this.callbacks[e],a=this.getWildcardCallbacks(e);if(o)for(i=o.slice(),t=0,n=i.length;n>t&&i[t];++t)i[t].apply(this,r);if(a)for(n=a.length,i=a.slice(),t=0,n=i.length;n>t&&i[t];++t)i[t].apply(this,[e].concat(r));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,i=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(i=i.concat(this.callbacks[t]));return i}},n.mixin(n)},{}],3:[function(e,t){function n(e){var t,n,u=this,d=e||{},l=this.config={url:"https://sandbox.simplewebrtc.com:443/",socketio:{},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,media:{video:!0,audio:!0},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},localVideo:{autoplay:!0,mirror:!0,muted:!0}};this.logger=function(){return e.debug?e.logger||console:e.logger||c}();for(t in d)this.config[t]=d[t];this.capabilities=o,r.call(this),n=this.connection=new s(this.config),u.emit("connectionReady",n.getSessionid()),u.sessionReady=!0,n.on("message",function(e){var t,n=u.webrtc.getPeers(e.from,e.roomType);"offer"===e.type?(n.length&&n.forEach(function(n){n.sid==e.sid&&(t=n)}),t||(t=u.webrtc.createPeer({id:e.from,sid:e.sid,type:e.roomType,enableDataChannels:u.config.enableDataChannels&&"screen"!==e.roomType,sharemyscreen:"screen"===e.roomType&&!e.broadcaster,broadcaster:"screen"!==e.roomType||e.broadcaster?null:u.connection.getSessionid()}),u.emit("createdPeer",t)),t.handleMessage(e)):n.length&&n.forEach(function(t){e.sid?t.sid===e.sid&&t.handleMessage(e):t.handleMessage(e)})}),n.on("remove",function(e){e.id!==u.connection.getSessionid()&&u.webrtc.removePeers(e.id,e.type)}),e.logger=this.logger,e.debug=!1,this.webrtc=new i(e),["mute","unmute","pauseVideo","resumeVideo","pause","resume","sendToAll","sendDirectlyToAll","getPeers"].forEach(function(e){u[e]=u.webrtc[e].bind(u.webrtc)}),this.webrtc.on("*",function(){u.emit.apply(u,arguments)}),l.debug&&this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:")),this.webrtc.on("localStream",function(){u.testReadiness()}),this.webrtc.on("message",function(e){u.connection.emit("message",e)}),this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this)),this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this)),this.config.adjustPeerVolume&&(this.webrtc.on("speaking",this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1))),n.emit("stunservers",function(e){u.webrtc.config.peerConnectionConfig.iceServers=e,u.emit("stunservers",e)}),n.emit("turnservers",function(e){u.webrtc.config.peerConnectionConfig.iceServers=u.webrtc.config.peerConnectionConfig.iceServers.concat(e),u.emit("turnservers",e)}),this.webrtc.on("iceFailed",function(){}),this.webrtc.on("connectivityError",function(){}),this.webrtc.on("audioOn",function(){u.webrtc.sendToAll("unmute",{name:"audio"})}),this.webrtc.on("audioOff",function(){u.webrtc.sendToAll("mute",{name:"audio"})}),this.webrtc.on("videoOn",function(){u.webrtc.sendToAll("unmute",{name:"video"})}),this.webrtc.on("videoOff",function(){u.webrtc.sendToAll("mute",{name:"video"})}),this.webrtc.on("localScreen",function(e){var t=document.createElement("video"),n=u.getRemoteVideoContainer();t.oncontextmenu=function(){return!1},t.id="localScreen",a(e,t),n&&n.appendChild(t),u.emit("localScreenAdded",t),u.connection.emit("shareScreen"),u.webrtc.peers.forEach(function(e){var t;"video"===e.type&&(t=u.webrtc.createPeer({id:e.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},broadcaster:u.connection.getSessionid()}),u.emit("createdPeer",t),t.start())})}),this.webrtc.on("localScreenStopped",function(){u.stopScreenShare()}),this.webrtc.on("channelMessage",function(e,t,n){"volume"==n.type&&u.emit("remoteVolumeChange",e,n.volume)}),this.config.autoRequestMedia&&this.startLocalVideo()}var i=e("./webrtc"),r=e("wildemitter"),o=e("webrtcsupport"),a=e("attachmediastream"),c=e("mockconsole"),s=e("./socketioconnection");n.prototype=Object.create(r.prototype,{constructor:{value:n}}),n.prototype.leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers.shift().end();this.getLocalScreen()&&this.stopScreenShare(),this.emit("leftRoom",this.roomName),this.roomName=void 0}},n.prototype.disconnect=function(){this.connection.disconnect(),delete this.connection},n.prototype.handlePeerStreamAdded=function(e){var t=this,n=this.getRemoteVideoContainer(),i=a(e.stream);e.videoEl=i,i.id=this.getDomId(e),n&&n.appendChild(i),this.emit("videoAdded",i,e),window.setTimeout(function(){t.webrtc.isAudioEnabled()||e.send("mute",{name:"audio"}),t.webrtc.isVideoEnabled()||e.send("mute",{name:"video"})},250)},n.prototype.handlePeerStreamRemoved=function(e){var t=this.getRemoteVideoContainer(),n=e.videoEl;this.config.autoRemoveVideos&&t&&n&&t.removeChild(n),n&&this.emit("videoRemoved",n,e)},n.prototype.getDomId=function(e){return[e.id,e.type,e.broadcaster?"broadcasting":"incoming"].join("_")},n.prototype.setVolumeForAll=function(e){this.webrtc.peers.forEach(function(t){t.videoEl&&(t.videoEl.volume=e)})},n.prototype.joinRoom=function(e,t){var n=this;this.roomName=e,this.connection.emit("join",e,function(i,r){if(console.log("join CB",i,r),i)n.emit("error",i);else{var o,a,c,s;for(o in r.clients){a=r.clients[o];for(c in a)a[c]&&(s=n.webrtc.createPeer({id:o,type:c,enableDataChannels:n.config.enableDataChannels&&"screen"!==c,receiveMedia:{offerToReceiveAudio:"screen"!==c&&n.config.receiveMedia.offerToReceiveAudio?1:0,offerToReceiveVideo:n.config.receiveMedia.offerToReceiveVideo}}),n.emit("createdPeer",s),s.start())}}t&&t(i,r),n.emit("joinedRoom",e)})},n.prototype.getEl=function(e){return"string"==typeof e?document.getElementById(e):e},n.prototype.startLocalVideo=function(){var e=this;this.webrtc.startLocalMedia(this.config.media,function(t,n){t?e.emit("localMediaError",t):a(n,e.getLocalVideoContainer(),e.config.localVideo)})},n.prototype.stopLocalVideo=function(){this.webrtc.stopLocalMedia()},n.prototype.getLocalVideoContainer=function(){var e=this.getEl(this.config.localVideoEl);if(e&&"VIDEO"===e.tagName)return e.oncontextmenu=function(){return!1},e;if(e){var t=document.createElement("video");return t.oncontextmenu=function(){return!1},e.appendChild(t),t}},n.prototype.getRemoteVideoContainer=function(){return this.getEl(this.config.remoteVideosEl)},n.prototype.shareScreen=function(e){this.webrtc.startScreenShare(e)},n.prototype.getLocalScreen=function(){return this.webrtc.localScreen},n.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var e=document.getElementById("localScreen"),t=this.getRemoteVideoContainer(),n=this.getLocalScreen();this.config.autoRemoveVideos&&t&&e&&t.removeChild(e),e&&this.emit("videoRemoved",e),n&&n.stop(),this.webrtc.peers.forEach(function(e){e.broadcaster&&e.end()})},n.prototype.testReadiness=function(){var e=this;this.webrtc.localStreams.length>0&&this.sessionReady&&e.emit("readyToCall",e.connection.getSessionid())},n.prototype.createRoom=function(e,t){this.roomName=e,2===arguments.length?this.connection.emit("create",e,t):this.connection.emit("create",e)},n.prototype.sendFile=function(){return o.dataChannel?void 0:this.emit("error",new Error("DataChannelNotSupported"))},t.exports=n},{"./socketioconnection":1,"./webrtc":4,attachmediastream:7,mockconsole:5,webrtcsupport:6,wildemitter:2}],5:[function(e,t){for(var n="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),i=n.length,r=function(){},o={};i--;)o[n[i]]=r;t.exports=o},{}],6:[function(e,t){var n,i;window.mozRTCPeerConnection||navigator.mozGetUserMedia?(n="moz",i=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)):(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)&&(n="webkit",i=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10));var r=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,o=window.mozRTCIceCandidate||window.RTCIceCandidate,a=window.mozRTCSessionDescription||window.RTCSessionDescription,c=window.webkitMediaStream||window.MediaStream,s="https:"===window.location.protocol&&("webkit"===n&&i>=26||"moz"===n&&i>=33),u=window.AudioContext||window.webkitAudioContext,d=document.createElement("video"),l=d&&d.canPlayType&&"probably"===d.canPlayType('video/webm; codecs="vp8", vorbis'),f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;t.exports={prefix:n,browserVersion:i,support:!!r&&!!f,supportRTCPeerConnection:!!r,supportVp8:l,supportGetUserMedia:!!f,supportDataChannel:!!(r&&r.prototype&&r.prototype.createDataChannel),supportWebAudio:!(!u||!u.prototype.createMediaStreamSource),supportMediaStream:!(!c||!c.prototype.removeTrack),supportScreenSharing:!!s,AudioContext:u,PeerConnection:r,SessionDescription:a,IceCandidate:o,MediaStream:c,getUserMedia:f}},{}],4:[function(e,t){function n(e){var t=this,n=e||{};this.config={debug:!1,peerConnectionConfig:{iceServers:[{urls:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},enableDataChannels:!0};var i;this.screenSharingSupport=r.screenSharing,this.logger=function(){return e.debug?e.logger||console:e.logger||o}();for(i in n)this.config[i]=n[i];r.support||this.logger.error("Your browser doesn't seem to support WebRTC"),this.peers=[],a.call(this,this.config),this.on("speaking",function(){t.hardMuted||t.peers.forEach(function(e){if(e.enableDataChannels){var t=e.getDataChannel("hark");if("open"!=t.readyState)return;t.send(JSON.stringify({type:"speaking"}))}})}),this.on("stoppedSpeaking",function(){t.hardMuted||t.peers.forEach(function(e){if(e.enableDataChannels){var t=e.getDataChannel("hark");if("open"!=t.readyState)return;t.send(JSON.stringify({type:"stoppedSpeaking"}))}})}),this.on("volumeChange",function(e){t.hardMuted||t.peers.forEach(function(t){if(t.enableDataChannels){var n=t.getDataChannel("hark");if("open"!=n.readyState)return;n.send(JSON.stringify({type:"volume",volume:e}))}})}),this.config.debug&&this.on("*",function(e,n,i){var r;r=t.config.logger===o?console:t.logger,r.log("event:",e,n,i)})}var i=e("util"),r=e("webrtcsupport");e("wildemitter");var o=e("mockconsole"),a=e("localmedia"),c=e("./peer");i.inherits(n,a),n.prototype.createPeer=function(e){var t;return e.parent=this,t=new c(e),this.peers.push(t),t},n.prototype.removePeers=function(e,t){this.getPeers(e,t).forEach(function(e){e.end()})},n.prototype.getPeers=function(e,t){return this.peers.filter(function(n){return!(e&&n.id!==e||t&&n.type!==t)})},n.prototype.sendToAll=function(e,t){this.peers.forEach(function(n){n.send(e,t)})},n.prototype.sendDirectlyToAll=function(e,t,n){this.peers.forEach(function(i){i.enableDataChannels&&i.sendDirectly(e,t,n)})},t.exports=n},{"./peer":9,localmedia:10,mockconsole:5,util:8,webrtcsupport:6,wildemitter:2}],8:[function(e,t,n){function i(e){return Array.isArray(e)||"object"==typeof e&&"[object Array]"===Object.prototype.toString.call(e)}function r(e){"object"==typeof e&&"[object RegExp]"===Object.prototype.toString.call(e)}function o(e){return"object"==typeof e&&"[object Date]"===Object.prototype.toString.call(e)}e("events"),n.isArray=i,n.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},n.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},n.print=function(){},n.puts=function(){},n.debug=function(){},n.inspect=function(e,t,s,u){function d(e,s){if(e&&"function"==typeof e.inspect&&e!==n&&(!e.constructor||e.constructor.prototype!==e))return e.inspect(s);switch(typeof e){case"undefined":return f("undefined","undefined");case"string":var u="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return f(u,"string");case"number":return f(""+e,"number");case"boolean":return f(""+e,"boolean")}if(null===e)return f("null","null");var p=a(e),h=t?c(e):p;if("function"==typeof e&&0===h.length){if(r(e))return f(""+e,"regexp");var m=e.name?": "+e.name:"";return f("[Function"+m+"]","special")}if(o(e)&&0===h.length)return f(e.toUTCString(),"date");var g,v,y;if(i(e)?(v="Array",y=["[","]"]):(v="Object",y=["{","}"]),"function"==typeof e){var b=e.name?": "+e.name:"";g=r(e)?" "+e:" [Function"+b+"]"}else g="";if(o(e)&&(g=" "+e.toUTCString()),0===h.length)return y[0]+g+y[1];if(0>s)return r(e)?f(""+e,"regexp"):f("[Object]","special");l.push(e);var w=h.map(function(t){var n,r;if(e.__lookupGetter__&&(e.__lookupGetter__(t)?r=e.__lookupSetter__(t)?f("[Getter/Setter]","special"):f("[Getter]","special"):e.__lookupSetter__(t)&&(r=f("[Setter]","special"))),p.indexOf(t)<0&&(n="["+t+"]"),r||(l.indexOf(e[t])<0?(r=null===s?d(e[t]):d(e[t],s-1),r.indexOf("\n")>-1&&(r=i(e)?r.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+r.split("\n").map(function(e){return"   "+e}).join("\n"))):r=f("[Circular]","special")),"undefined"==typeof n){if("Array"===v&&t.match(/^\d+$/))return r;n=JSON.stringify(""+t),n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=f(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=f(n,"string"))}return n+": "+r});l.pop();var S=0,C=w.reduce(function(e,t){return S++,t.indexOf("\n")>=0&&S++,e+t.length+1},0);return w=C>50?y[0]+(""===g?"":g+"\n ")+" "+w.join(",\n  ")+" "+y[1]:y[0]+g+" "+w.join(", ")+" "+y[1]}var l=[],f=function(e,t){var n={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i={special:"cyan",number:"blue","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[t];return i?"["+n[i][0]+"m"+e+"["+n[i][1]+"m":e};return u||(f=function(e){return e}),d(e,"undefined"==typeof s?2:s)},n.log=function(){},n.pump=null;var a=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},c=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.hasOwnProperty.call(e,n)&&t.push(n);return t},s=Object.create||function(e,t){var n;if(null===e)n={__proto__:null};else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var i=function(){};i.prototype=e,n=new i,n.__proto__=e}return"undefined"!=typeof t&&Object.defineProperties&&Object.defineProperties(n,t),n};n.inherits=function(e,t){e.super_=t,e.prototype=s(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})};var u=/%[sdj%]/g;n.format=function(e){if("string"!=typeof e){for(var t=[],i=0;i<arguments.length;i++)t.push(n.inspect(arguments[i]));return t.join(" ")}for(var i=1,r=arguments,o=r.length,a=String(e).replace(u,function(e){if("%%"===e)return"%";if(i>=o)return e;switch(e){case"%s":return String(r[i++]);case"%d":return Number(r[i++]);case"%j":return JSON.stringify(r[i++]);default:return e}}),c=r[i];o>i;c=r[++i])a+=null===c||"object"!=typeof c?" "+c:" "+n.inspect(c);return a}},{events:11}],12:[function(e,t){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var i=n.shift();i()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],11:[function(e,t,n){function i(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}var r=e("__browserify_process");r.EventEmitter||(r.EventEmitter=function(){});var o=n.EventEmitter=r.EventEmitter,a="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},c=10;o.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._events.maxListeners=e},o.prototype.emit=function(e){if("error"===e&&(!this._events||!this._events.error||a(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var t=this._events[e];if(!t)return!1;if("function"==typeof t){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);t.apply(this,n)}return!0}if(a(t)){for(var n=Array.prototype.slice.call(arguments,1),i=t.slice(),r=0,o=i.length;o>r;r++)i[r].apply(this,n);return!0}return!1},o.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",e,t),this._events[e])if(a(this._events[e])){if(!this._events[e].warned){var n;n=void 0!==this._events.maxListeners?this._events.maxListeners:c,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}this._events[e].push(t)}else this._events[e]=[this._events[e],t];else this._events[e]=t;return this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(e,t){var n=this;return n.on(e,function i(){n.removeListener(e,i),t.apply(this,arguments)}),this},o.prototype.removeListener=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var n=this._events[e];if(a(n)){var r=i(n,t);if(0>r)return this;n.splice(r,1),0==n.length&&delete this._events[e]}else this._events[e]===t&&delete this._events[e];return this},o.prototype.removeAllListeners=function(e){return 0===arguments.length?(this._events={},this):(e&&this._events&&this._events[e]&&(this._events[e]=null),this)},o.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),a(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},o.listenerCount=function(e,t){var n;return n=e._events&&e._events[t]?"function"==typeof e._events[t]?1:e._events[t].length:0}},{__browserify_process:12}],9:[function(e,t){function n(e){var t=this;a.call(this),this.id=e.id,this.parent=e.parent,this.type=e.type||"video",this.oneway=e.oneway||!1,this.sharemyscreen=e.sharemyscreen||!1,this.browserPrefix=e.prefix,this.stream=e.stream,this.enableDataChannels=void 0===e.enableDataChannels?this.parent.config.enableDataChannels:e.enableDataChannels,this.receiveMedia=e.receiveMedia||this.parent.config.receiveMedia,this.channels={},this.sid=e.sid||Date.now().toString(),this.pc=new o(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints),this.pc.on("ice",this.onIceCandidate.bind(this)),this.pc.on("endOfCandidates",function(e){t.send("endOfCandidates",e)}),this.pc.on("offer",function(e){t.parent.config.nick&&(e.nick=t.parent.config.nick),t.send("offer",e)}),this.pc.on("answer",function(e){t.parent.config.nick&&(e.nick=t.parent.config.nick),t.send("answer",e)}),this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this)),this.pc.on("addChannel",this.handleDataChannelAdded.bind(this)),this.pc.on("removeStream",this.handleStreamRemoved.bind(this)),this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded")),this.pc.on("iceConnectionStateChange",this.emit.bind(this,"iceConnectionStateChange")),this.pc.on("iceConnectionStateChange",function(){switch(t.pc.iceConnectionState){case"failed":"offer"===t.pc.pc.peerconnection.localDescription.type&&(t.parent.emit("iceFailed",t),t.send("connectivityError"))}}),this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange")),this.logger=this.parent.logger,"screen"===e.type?this.parent.localScreen&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreen),this.broadcaster=e.broadcaster):this.parent.localStreams.forEach(function(e){t.pc.addStream(e)}),this.on("channelOpen",function(e){e.protocol===s&&(e.onmessage=function(n){var i=JSON.parse(n.data),r=new c.Receiver;r.receive(i,e),t.emit("fileTransfer",i,r),r.on("receivedFile",function(){r.channel.close()})})}),this.on("*",function(){t.parent.emit.apply(t.parent,arguments)})}var i=e("util"),r=e("webrtcsupport"),o=e("rtcpeerconnection"),a=e("wildemitter"),c=e("filetransfer"),s="https://simplewebrtc.com/protocol/filetransfer#inband-v1";i.inherits(n,a),n.prototype.handleMessage=function(e){var t=this;if(this.logger.log("getting",e.type,e),e.prefix&&(this.browserPrefix=e.prefix),"offer"===e.type)this.nick||(this.nick=e.payload.nick),delete e.payload.nick,this.pc.handleOffer(e.payload,function(e){e||t.pc.answer(function(){})});else if("answer"===e.type)this.nick||(this.nick=e.payload.nick),delete e.payload.nick,this.pc.handleAnswer(e.payload);else if("candidate"===e.type)this.pc.processIce(e.payload);else if("connectivityError"===e.type)this.parent.emit("connectivityError",t);else if("mute"===e.type)this.parent.emit("mute",{id:e.from,name:e.payload.name});else if("unmute"===e.type)this.parent.emit("unmute",{id:e.from,name:e.payload.name});else if("endOfCandidates"===e.type){var n=this.pc.pc.peerconnection.transceivers||[];n.forEach(function(e){e.iceTransport&&e.iceTransport.addRemoteCandidate({})})}},n.prototype.send=function(e,t){var n={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:e,payload:t,prefix:r.prefix};this.logger.log("sending",e,n),this.parent.emit("message",n)},n.prototype.sendDirectly=function(e,t,n){var i={type:t,payload:n};this.logger.log("sending via datachannel",e,t,i);var r=this.getDataChannel(e);return"open"!=r.readyState?!1:(r.send(JSON.stringify(i)),!0)},n.prototype._observeDataChannel=function(e){var t=this;e.onclose=this.emit.bind(this,"channelClose",e),e.onerror=this.emit.bind(this,"channelError",e),e.onmessage=function(n){t.emit("channelMessage",t,e.label,JSON.parse(n.data),e,n)},e.onopen=this.emit.bind(this,"channelOpen",e)},n.prototype.getDataChannel=function(e,t){if(!r.supportDataChannel)return this.emit("error",new Error("createDataChannel not supported"));var n=this.channels[e];return t||(t={}),n?n:(n=this.channels[e]=this.pc.createDataChannel(e,t),this._observeDataChannel(n),n)},n.prototype.onIceCandidate=function(e){if(!this.closed)if(e){var t=this.parent.config.peerConnectionConfig;"moz"===r.prefix&&t&&t.iceTransports&&e.candidate&&e.candidate.candidate&&e.candidate.candidate.indexOf(t.iceTransports)<0?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",t.iceTransports):this.send("candidate",e)}else this.logger.log("End of candidates.")},n.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc"),this.pc.offer(this.receiveMedia,function(){})},n.prototype.icerestart=function(){var e=this.receiveMedia;e.mandatory.IceRestart=!0,this.pc.offer(e,function(){})},n.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())},n.prototype.handleRemoteStreamAdded=function(e){var t=this;this.stream?this.logger.warn("Already have a remote stream"):(this.stream=e.stream,this.stream.onended=function(){t.end()},this.parent.emit("peerStreamAdded",this))},n.prototype.handleStreamRemoved=function(){this.parent.peers.splice(this.parent.peers.indexOf(this),1),this.closed=!0,this.parent.emit("peerStreamRemoved",this)},n.prototype.handleDataChannelAdded=function(e){this.channels[e.label]=e,this._observeDataChannel(e)},n.prototype.sendFile=function(e){var t=new c.Sender,n=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:s});return n.onopen=function(){n.send(JSON.stringify({size:e.size,name:e.name})),t.send(e,n)},n.onclose=function(){console.log("sender received transfer"),t.emit("complete")},t},t.exports=n},{filetransfer:13,rtcpeerconnection:14,util:8,webrtcsupport:6,wildemitter:2}],7:[function(e,t){var n=e("webrtc-adapter-test");t.exports=function(e,t,i){var r;window.URL;var o=t,a={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};if(i)for(r in i)a[r]=i[r];return o?"audio"===o.tagName.toLowerCase()&&(a.audio=!0):o=document.createElement(a.audio?"audio":"video"),a.disableContextMenu&&(o.oncontextmenu=function(e){e.preventDefault()}),a.autoplay&&(o.autoplay="autoplay"),a.muted&&(o.muted=!0),!a.audio&&a.mirror&&["","moz","webkit","o","ms"].forEach(function(e){var t=e?e+"Transform":"transform";o.style[t]="scaleX(-1)"}),n.attachMediaStream(o,e),o}},{"webrtc-adapter-test":15}],15:[function(t,n){"use strict";function i(e){return new Promise(function(t,n){r(e,t,n)})}var r=null,o=null,a=null,c=null,s=null,u=null,d={log:function(){"undefined"!=typeof n||"function"==typeof t&&"function"==typeof e||console.log.apply(console,arguments)},extractVersion:function(e,t,n){var i=e.match(t);return i&&i.length>=n&&parseInt(i[n])}};if("object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject},set:function(e){"mozSrcObject"in this?this.mozSrcObject=e:(this._srcObject=e,this.src=URL.createObjectURL(e))}}),r=window.navigator&&window.navigator.getUserMedia),o=function(e,t){e.srcObject=t},a=function(e,t){e.srcObject=t.srcObject},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){if(d.log("This appears to be Firefox"),c="firefox",s=d.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),u=31,window.RTCPeerConnection=function(e,t){if(38>s&&e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var r=e.iceServers[i];if(r.hasOwnProperty("urls"))for(var o=0;o<r.urls.length;o++){var a={url:r.urls[o]};0===r.urls[o].indexOf("turn")&&(a.username=r.username,a.credential=r.credential),n.push(a)}else n.push(e.iceServers[i])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCSessionDescription||(window.RTCSessionDescription=mozRTCSessionDescription),window.RTCIceCandidate||(window.RTCIceCandidate=mozRTCIceCandidate),r=function(e,t,n){var i=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if((void 0!==i.min||void 0!==i.max||void 0!==i.exact)&&t.push(n),void 0!==i.exact&&("number"==typeof i.exact?i.min=i.max=i.exact:e[n]=i.exact,delete i.exact),void 0!==i.ideal){e.advanced=e.advanced||[];var r={};r[n]="number"==typeof i.ideal?{min:i.ideal,max:i.ideal}:i.ideal,e.advanced.push(r),delete i.ideal,Object.keys(i).length||delete e[n]}}}),t.length&&(e.require=t),e};return 38>s&&(d.log("spec: "+JSON.stringify(e)),e.audio&&(e.audio=i(e.audio)),e.video&&(e.video=i(e.video)),d.log("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,t,n)},navigator.getUserMedia=r,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:i,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},41>s){var l=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return l().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){d.log("This appears to be Chrome"),c="chrome",s=d.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),u=38,window.RTCPeerConnection=function(e,t){e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),i=n.getStats.bind(n);return n.getStats=function(e,t){var n=this,r=arguments;if(arguments.length>0&&"function"==typeof e)return i(e,t);var o=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t};if(arguments.length>=2){var a=function(e){r[1](o(e))};return i.apply(this,[a,arguments[0]])}return new Promise(function(t,a){1===r.length&&null===e?i.apply(n,[function(e){t.apply(null,[o(e)])},a]):i.apply(n,[t,a])})},n},["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(i,r){t.apply(e,[i,r,n])})}return t.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this;return new Promise(function(i,r){t.apply(n,[e[0],function(){i(),e.length>=2&&e[1].apply(null,[])},function(t){r(t),e.length>=3&&e[2].apply(null,[t])}])})}});var f=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;
var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var o={};"number"==typeof i.ideal?(o[r("min",n)]=i.ideal,t.optional.push(o),o={},o[r("max",n)]=i.ideal,t.optional.push(o)):(o[r("",n)]=i.ideal,t.optional.push(o))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach(function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};if(r=function(e,t,n){return e.audio&&(e.audio=f(e.audio)),e.video&&(e.video=f(e.video)),d.log("chrome: "+JSON.stringify(e)),navigator.webkitGetUserMedia(e,t,n)},navigator.getUserMedia=r,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:i,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var p=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return d.log("spec:   "+JSON.stringify(e)),e.audio=f(e.audio),e.video=f(e.video),d.log("chrome: "+JSON.stringify(e)),p(e)}}else navigator.mediaDevices.getUserMedia=function(e){return i(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){d.log("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){d.log("Dummy mediaDevices.removeEventListener called.")}),o=function(e,t){s>=43?e.srcObject=t:"undefined"!=typeof e.src?e.src=URL.createObjectURL(t):d.log("Error attaching stream to element.")},a=function(e,t){s>=43?e.srcObject=t.srcObject:e.src=t.src}}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(d.log("This appears to be Edge"),c="edge",s=d.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),u=12):d.log("Browser does not appear to be WebRTC-capable");else d.log("This does not appear to be a browser"),c="not a browser";var h={};try{Object.defineProperty(h,"version",{set:function(e){s=e}})}catch(m){}if("undefined"!=typeof n){var g;"undefined"!=typeof window&&(g=window.RTCPeerConnection),n.exports={RTCPeerConnection:g,getUserMedia:r,attachMediaStream:o,reattachMediaStream:a,webrtcDetectedBrowser:c,webrtcDetectedVersion:s,webrtcMinimumVersion:u,webrtcTesting:h,webrtcUtils:d}}else"function"==typeof t&&"function"==typeof e&&e([],function(){return{RTCPeerConnection:window.RTCPeerConnection,getUserMedia:r,attachMediaStream:o,reattachMediaStream:a,webrtcDetectedBrowser:c,webrtcDetectedVersion:s,webrtcMinimumVersion:u,webrtcTesting:h,webrtcUtils:d}})},{}],16:[function(e,t){var n,i;window.mozRTCPeerConnection||navigator.mozGetUserMedia?(n="moz",i=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)):(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)&&(n="webkit",i=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10));var r=window.mozRTCPeerConnection||window.webkitRTCPeerConnection,o=window.mozRTCIceCandidate||window.RTCIceCandidate,a=window.mozRTCSessionDescription||window.RTCSessionDescription,c=window.webkitMediaStream||window.MediaStream,s="https:"===window.location.protocol&&("webkit"===n&&i>=26||"moz"===n&&i>=33),u=window.AudioContext||window.webkitAudioContext,d=document.createElement("video"),l=d&&d.canPlayType&&"probably"===d.canPlayType('video/webm; codecs="vp8", vorbis'),f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;t.exports={prefix:n,browserVersion:i,support:!!r&&l&&!!f,supportRTCPeerConnection:!!r,supportVp8:l,supportGetUserMedia:!!f,supportDataChannel:!!(r&&r.prototype&&r.prototype.createDataChannel),supportWebAudio:!(!u||!u.prototype.createMediaStreamSource),supportMediaStream:!(!c||!c.prototype.removeTrack),supportScreenSharing:!!s,dataChannel:!!(r&&r.prototype&&r.prototype.createDataChannel),webAudio:!(!u||!u.prototype.createMediaStreamSource),mediaStream:!(!c||!c.prototype.removeTrack),screenSharing:!!s,AudioContext:u,PeerConnection:r,SessionDescription:a,IceCandidate:o,MediaStream:c,getUserMedia:f}},{}],10:[function(e,t){function n(e){s.call(this);var t,n=this.config={autoAdjustMic:!1,detectSpeakingEvents:!1,audioFallback:!1,media:{audio:!0,video:!0},logger:d};for(t in e)this.config[t]=e[t];this.logger=n.logger,this._log=this.logger.log.bind(this.logger,"LocalMedia:"),this._logerror=this.logger.error.bind(this.logger,"LocalMedia:"),this.screenSharingSupport=o.screenSharing,this.localStreams=[],this.localScreens=[],o.support||this._logerror("Your browser does not support local media capture.")}var i=e("util"),r=e("hark"),o=e("webrtcsupport"),a=e("getusermedia"),c=e("getscreenmedia"),s=e("wildemitter"),u=e("mediastream-gain"),d=e("mockconsole");i.inherits(n,s),n.prototype.start=function(e,t){var n=this,i=e||this.config.media;a(i,function(e,r){if(e){if(n.config.audioFallback&&"DevicesNotFoundError"===e.name&&i.video!==!1)return i.video=!1,n.start(i,t),void 0}else i.audio&&n.config.detectSpeakingEvents&&n.setupAudioMonitor(r,n.config.harkOptions),n.localStreams.push(r),n.config.autoAdjustMic&&(n.gainController=new u(r),n.setMicIfEnabled(.5)),r.onended=function(){},n.emit("localStream",r);return t?t(e,r):void 0})},n.prototype.stop=function(e){var t=this;if(e){e.getTracks().forEach(function(e){e.stop()});var n=t.localStreams.indexOf(e);n>-1?(t.emit("localStreamStopped",e),t.localStreams=t.localStreams.splice(n,1)):(n=t.localScreens.indexOf(e),n>-1&&(t.emit("localScreenStopped",e),t.localScreens=t.localScreens.splice(n,1)))}else this.stopStreams(),this.stopScreenShare()},n.prototype.stopStreams=function(){var e=this;this.audioMonitor&&(this.audioMonitor.stop(),delete this.audioMonitor),this.localStreams.forEach(function(t){t.getTracks().forEach(function(e){e.stop()}),e.emit("localStreamStopped",t)}),this.localStreams=[]},n.prototype.startScreenShare=function(e){var t=this;c(function(n,i){return n||(t.localScreens.push(i),i.onended=function(){var e=t.localScreens.indexOf(i);e>-1&&t.localScreens.splice(e,1),t.emit("localScreenStopped",i)},t.emit("localScreen",i)),e?e(n,i):void 0})},n.prototype.stopScreenShare=function(e){var t=this;e?(e.getTracks().forEach(function(e){e.stop()}),this.emit("localScreenStopped",e)):(this.localScreens.forEach(function(e){e.getTracks().forEach(function(e){e.stop()}),t.emit("localScreenStopped",e)}),this.localScreens=[])},n.prototype.mute=function(){this._audioEnabled(!1),this.hardMuted=!0,this.emit("audioOff")},n.prototype.unmute=function(){this._audioEnabled(!0),this.hardMuted=!1,this.emit("audioOn")},n.prototype.setupAudioMonitor=function(e,t){this._log("Setup audio");var n,i=this.audioMonitor=r(e,t),o=this;i.on("speaking",function(){o.emit("speaking"),o.hardMuted||o.setMicIfEnabled(1)}),i.on("stopped_speaking",function(){n&&clearTimeout(n),n=setTimeout(function(){o.emit("stoppedSpeaking"),o.hardMuted||o.setMicIfEnabled(.5)},1e3)}),i.on("volume_change",function(e,t){o.emit("volumeChange",e,t)})},n.prototype.setMicIfEnabled=function(e){this.config.autoAdjustMic&&this.gainController.setGain(e)},n.prototype.pauseVideo=function(){this._videoEnabled(!1),this.emit("videoOff")},n.prototype.resumeVideo=function(){this._videoEnabled(!0),this.emit("videoOn")},n.prototype.pause=function(){this.mute(),this.pauseVideo()},n.prototype.resume=function(){this.unmute(),this.resumeVideo()},n.prototype._audioEnabled=function(e){this.setMicIfEnabled(e?1:0),this.localStreams.forEach(function(t){t.getAudioTracks().forEach(function(t){t.enabled=!!e})})},n.prototype._videoEnabled=function(e){this.localStreams.forEach(function(t){t.getVideoTracks().forEach(function(t){t.enabled=!!e})})},n.prototype.isAudioEnabled=function(){var e=!0;return this.localStreams.forEach(function(t){t.getAudioTracks().forEach(function(t){e=e&&t.enabled})}),e},n.prototype.isVideoEnabled=function(){var e=!0;return this.localStreams.forEach(function(t){t.getVideoTracks().forEach(function(t){e=e&&t.enabled})}),e},n.prototype.startLocalMedia=n.prototype.start,n.prototype.stopLocalMedia=n.prototype.stop,Object.defineProperty(n.prototype,"localStream",{get:function(){return this.localStreams.length>0?this.localStreams[0]:null}}),Object.defineProperty(n.prototype,"localScreen",{get:function(){return this.localScreens.length>0?this.localScreens[0]:null}}),t.exports=n},{getscreenmedia:20,getusermedia:18,hark:17,"mediastream-gain":19,mockconsole:5,util:8,webrtcsupport:16,wildemitter:2}],21:[function(t,n){"use strict";function i(e){return new Promise(function(t,n){r(e,t,n)})}var r=null,o=null,a=null,c=null,s=null,u=null,d={log:function(){"undefined"!=typeof n||"function"==typeof t&&"function"==typeof e||console.log.apply(console,arguments)},extractVersion:function(e,t,n){var i=e.match(t);return i&&i.length>=n&&parseInt(i[n])}};if("object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject},set:function(e){"mozSrcObject"in this?this.mozSrcObject=e:(this._srcObject=e,this.src=URL.createObjectURL(e))}}),r=window.navigator&&window.navigator.getUserMedia),o=function(e,t){e.srcObject=t},a=function(e,t){e.srcObject=t.srcObject},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){if(d.log("This appears to be Firefox"),c="firefox",s=d.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),u=31,window.RTCPeerConnection=function(e,t){if(38>s&&e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var r=e.iceServers[i];if(r.hasOwnProperty("urls"))for(var o=0;o<r.urls.length;o++){var a={url:r.urls[o]};0===r.urls[o].indexOf("turn")&&(a.username=r.username,a.credential=r.credential),n.push(a)}else n.push(e.iceServers[i])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCSessionDescription||(window.RTCSessionDescription=mozRTCSessionDescription),window.RTCIceCandidate||(window.RTCIceCandidate=mozRTCIceCandidate),r=function(e,t,n){var i=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if((void 0!==i.min||void 0!==i.max||void 0!==i.exact)&&t.push(n),void 0!==i.exact&&("number"==typeof i.exact?i.min=i.max=i.exact:e[n]=i.exact,delete i.exact),void 0!==i.ideal){e.advanced=e.advanced||[];var r={};r[n]="number"==typeof i.ideal?{min:i.ideal,max:i.ideal}:i.ideal,e.advanced.push(r),delete i.ideal,Object.keys(i).length||delete e[n]}}}),t.length&&(e.require=t),e};return 38>s&&(d.log("spec: "+JSON.stringify(e)),e.audio&&(e.audio=i(e.audio)),e.video&&(e.video=i(e.video)),d.log("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,t,n)},navigator.getUserMedia=r,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:i,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},41>s){var l=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return l().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){d.log("This appears to be Chrome"),c="chrome",s=d.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),u=38,window.RTCPeerConnection=function(e,t){e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),i=n.getStats.bind(n);return n.getStats=function(e,t){var n=this,r=arguments;if(arguments.length>0&&"function"==typeof e)return i(e,t);var o=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t};if(arguments.length>=2){var a=function(e){r[1](o(e))};return i.apply(this,[a,arguments[0]])}return new Promise(function(t,a){1===r.length&&null===e?i.apply(n,[function(e){t.apply(null,[o(e)])},a]):i.apply(n,[t,a])})},n},["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(i,r){t.apply(e,[i,r,n])})}return t.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this;return new Promise(function(i,r){t.apply(n,[e[0],function(){i(),e.length>=2&&e[1].apply(null,[])},function(t){r(t),e.length>=3&&e[2].apply(null,[t])}])})}});var f=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var o={};"number"==typeof i.ideal?(o[r("min",n)]=i.ideal,t.optional.push(o),o={},o[r("max",n)]=i.ideal,t.optional.push(o)):(o[r("",n)]=i.ideal,t.optional.push(o))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach(function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};if(r=function(e,t,n){return e.audio&&(e.audio=f(e.audio)),e.video&&(e.video=f(e.video)),d.log("chrome: "+JSON.stringify(e)),navigator.webkitGetUserMedia(e,t,n)},navigator.getUserMedia=r,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:i,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var p=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return d.log("spec:   "+JSON.stringify(e)),e.audio=f(e.audio),e.video=f(e.video),d.log("chrome: "+JSON.stringify(e)),p(e)}}else navigator.mediaDevices.getUserMedia=function(e){return i(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){d.log("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){d.log("Dummy mediaDevices.removeEventListener called.")}),o=function(e,t){s>=43?e.srcObject=t:"undefined"!=typeof e.src?e.src=URL.createObjectURL(t):d.log("Error attaching stream to element.")},a=function(e,t){s>=43?e.srcObject=t.srcObject:e.src=t.src}}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(d.log("This appears to be Edge"),c="edge",s=d.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),u=12):d.log("Browser does not appear to be WebRTC-capable");else d.log("This does not appear to be a browser"),c="not a browser";var h={};try{Object.defineProperty(h,"version",{set:function(e){s=e}})}catch(m){}if("undefined"!=typeof n){var g;"undefined"!=typeof window&&(g=window.RTCPeerConnection),n.exports={RTCPeerConnection:g,getUserMedia:r,attachMediaStream:o,reattachMediaStream:a,webrtcDetectedBrowser:c,webrtcDetectedVersion:s,webrtcMinimumVersion:u,webrtcTesting:h,webrtcUtils:d}}else"function"==typeof t&&"function"==typeof e&&e([],function(){return{RTCPeerConnection:window.RTCPeerConnection,getUserMedia:r,attachMediaStream:o,reattachMediaStream:a,webrtcDetectedBrowser:c,webrtcDetectedVersion:s,webrtcMinimumVersion:u,webrtcTesting:h,webrtcUtils:d}})},{}],13:[function(e,t){function n(e){r.call(this);var t=e||{};this.config={chunksize:16384,pacing:0};var n;for(n in t)this.config[n]=t[n];this.file=null,this.channel=null}function i(){r.call(this),this.receiveBuffer=[],this.received=0,this.metadata={},this.channel=null}var r=e("wildemitter"),o=e("util");o.inherits(n,r),n.prototype.send=function(e,t){var n=this;this.file=e,this.channel=t;var i=function(t){var r=new window.FileReader;r.onload=function(){return function(r){n.channel.send(r.target.result),n.emit("progress",t,e.size,r.target.result),e.size>t+r.target.result.byteLength?window.setTimeout(i,n.config.pacing,t+n.config.chunksize):(n.emit("progress",e.size,e.size,null),n.emit("sentFile"))}}(e);var o=e.slice(t,t+n.config.chunksize);r.readAsArrayBuffer(o)};window.setTimeout(i,0,0)},o.inherits(i,r),i.prototype.receive=function(e,t){var n=this;e&&(this.metadata=e),this.channel=t,t.binaryType="arraybuffer",this.channel.onmessage=function(e){var t=e.data.byteLength;n.received+=t,n.receiveBuffer.push(e.data),n.emit("progress",n.received,n.metadata.size,e.data),n.received===n.metadata.size?(n.emit("receivedFile",new window.Blob(n.receiveBuffer),n.metadata),n.receiveBuffer=[]):n.received>n.metadata.size&&(console.error("received more than expected, discarding..."),n.receiveBuffer=[])}},t.exports={},t.exports.support="undefined"!=typeof window&&window&&window.File&&window.FileReader&&window.Blob,t.exports.Sender=n,t.exports.Receiver=i},{util:8,wildemitter:2}],14:[function(e,t){function n(e,t){var n,i=this;c.call(this),e=e||{},e.iceServers=e.iceServers||[],this.enableChromeNativeSimulcast=!1,t&&t.optional&&"chrome"===u.webrtcDetectedBrowser&&null===navigator.appVersion.match(/Chromium\//)&&t.optional.forEach(function(e){e.enableChromeNativeSimulcast&&(i.enableChromeNativeSimulcast=!0)}),this.enableMultiStreamHacks=!1,t&&t.optional&&"chrome"===u.webrtcDetectedBrowser&&t.optional.forEach(function(e){e.enableMultiStreamHacks&&(i.enableMultiStreamHacks=!0)}),this.restrictBandwidth=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetRestrictBandwidth&&(i.restrictBandwidth=e.andyetRestrictBandwidth)}),this.batchIceCandidates=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetBatchIce&&(i.batchIceCandidates=e.andyetBatchIce)}),this.batchedIceCandidates=[],t&&t.optional&&"chrome"===u.webrtcDetectedBrowser&&t.optional.forEach(function(e){e.andyetFasterICE&&(i.eliminateDuplicateCandidates=e.andyetFasterICE)}),t&&t.optional&&t.optional.forEach(function(e){e.andyetDontSignalCandidates&&(i.dontSignalCandidates=e.andyetDontSignalCandidates)}),this.assumeSetLocalSuccess=!1,t&&t.optional&&t.optional.forEach(function(e){e.andyetAssumeSetLocalSuccess&&(i.assumeSetLocalSuccess=e.andyetAssumeSetLocalSuccess)}),"firefox"===u.webrtcDetectedBrowser&&t&&t.optional&&(this.wtFirefox=0,t.optional.forEach(function(e){e.andyetFirefoxMakesMeSad&&(i.wtFirefox=e.andyetFirefoxMakesMeSad,i.wtFirefox>0&&(i.firefoxcandidatebuffer=[]))})),this.pc=new s(e,t),this.getLocalStreams=this.pc.getLocalStreams.bind(this.pc),this.getRemoteStreams=this.pc.getRemoteStreams.bind(this.pc),this.addStream=this.pc.addStream.bind(this.pc),this.removeStream=this.pc.removeStream.bind(this.pc),this.pc.on("*",function(){i.emit.apply(i,arguments)}),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onaddstream=this.emit.bind(this,"addStream"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.localDescription={contents:[]},this.remoteDescription={contents:[]},this.config={debug:!1,ice:{},sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1};for(n in e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){var t=e.logger||console;t.log("PeerConnection event:",arguments)}),this.hadLocalStunCandidate=!1,this.hadRemoteStunCandidate=!1,this.hadLocalRelayCandidate=!1,this.hadRemoteRelayCandidate=!1,this.hadLocalIPv6Candidate=!1,this.hadRemoteIPv6Candidate=!1,this._remoteDataChannels=[],this._localDataChannels=[],this._candidateBuffer=[]}var i=e("util"),r=e("lodash.foreach"),o=e("lodash.pluck"),a=e("sdp-jingle-json"),c=e("wildemitter"),s=e("traceablepeerconnection"),u=e("webrtc-adapter-test");i.inherits(n,c),Object.defineProperty(n.prototype,"signalingState",{get:function(){return this.pc.signalingState}}),Object.defineProperty(n.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}}),n.prototype._role=function(){return this.isInitiator?"initiator":"responder"},n.prototype.addStream=function(e){this.localStream=e,this.pc.addStream(e)},n.prototype._checkLocalCandidate=function(e){var t=a.toCandidateJSON(e);"srflx"==t.type?this.hadLocalStunCandidate=!0:"relay"==t.type&&(this.hadLocalRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)},n.prototype._checkRemoteCandidate=function(e){var t=a.toCandidateJSON(e);"srflx"==t.type?this.hadRemoteStunCandidate=!0:"relay"==t.type&&(this.hadRemoteRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)},n.prototype.processIce=function(e,t){t=t||function(){};var n=this;if("closed"===this.pc.signalingState)return t();if(e.contents||e.jingle&&e.jingle.contents){var i=o(this.remoteDescription.contents,"name"),r=e.contents||e.jingle.contents;r.forEach(function(e){var t=e.transport||{},r=t.candidates||[],o=i.indexOf(e.name),c=e.name;r.forEach(function(e){var t=a.toCandidateSDP(e)+"\r\n";n.pc.addIceCandidate(new RTCIceCandidate({candidate:t,sdpMLineIndex:o,sdpMid:c}),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(t)})})}else{if(e.candidate&&0!==e.candidate.candidate.indexOf("a=")&&(e.candidate.candidate="a="+e.candidate.candidate),this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(e.candidate),t();n.pc.addIceCandidate(new RTCIceCandidate(e.candidate),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate.candidate)}t()},n.prototype.offer=function(e,t){var n=this,i=2===arguments.length,o=i&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};return t=i?t:e,t=t||function(){},"closed"===this.pc.signalingState?t("Already closed"):(this.pc.createOffer(function(e){var i={type:"offer",sdp:e.sdp};n.assumeSetLocalSuccess&&(n.emit("offer",i),t(null,i)),n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){var o;n.config.useJingle&&(o=a.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),o.sid=n.config.sid,n.localDescription=o,r(o.contents,function(e){var t=e.transport||{};t.ufrag&&(n.config.ice[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),i.jingle=o),i.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("offer",i),t(null,i))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},o),void 0)},n.prototype.handleOffer=function(e,t){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(this.enableChromeNativeSimulcast&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.description.googConferenceFlag=!0)}),this.enableMultiStreamHacks&&e.jingle.contents.forEach(function(e){if("video"===e.name){var t=e.description.sources||[];(0===t.length||"3735928559"!==t[0].ssrc)&&(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),e.description.sources=t)}}),n.restrictBandwidth>0&&e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name){var i=e.jingle.contents[1],r=i.description&&i.description.bandwidth;r||(e.jingle.contents[1].description.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=a.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.sdp=a.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle}e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){t()},t)},n.prototype.answerAudioOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}};this._answer(t,e)},n.prototype.answerBroadcastOnly=function(e){var t={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};this._answer(t,e)},n.prototype.answer=function(e,t){var n=2===arguments.length,i=n?t:e,r=n&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(r,i)},n.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.jingle&&(e.sdp=a.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle),e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new RTCIceCandidate(e),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},n.prototype.close=function(){this.pc.close(),this._localDataChannels=[],this._remoteDataChannels=[],this.emit("close")},n.prototype._answer=function(e,t){t=t||function(){};var n=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");return"closed"===this.pc.signalingState?t("Already closed"):(n.pc.createAnswer(function(e){var i=[];if(n.enableChromeNativeSimulcast&&(e.jingle=a.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"}),e.jingle.contents.length>=2&&"video"===e.jingle.contents[1].name)){var r=e.jingle.contents[1].description.sourceGroups||[],o=!1;if(r.forEach(function(e){"SIM"==e.semantics&&(o=!0)}),!o&&e.jingle.contents[1].description.sources.length){var c=JSON.parse(JSON.stringify(e.jingle.contents[1].description.sources[0]));c.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].description.sources.push(c),i.push(e.jingle.contents[1].description.sources[0].ssrc),i.push(c.ssrc),r.push({semantics:"SIM",sources:i});var s=JSON.parse(JSON.stringify(c));s.ssrc=""+Math.floor(4294967295*Math.random()),e.jingle.contents[1].description.sources.push(s),r.push({semantics:"FID",sources:[c.ssrc,s.ssrc]}),e.jingle.contents[1].description.sourceGroups=r,e.sdp=a.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"})}}var u={type:"answer",sdp:e.sdp};n.assumeSetLocalSuccess&&(n.emit("answer",u),t(null,u)),n._candidateBuffer=[],n.pc.setLocalDescription(e,function(){if(n.config.useJingle){var i=a.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"});i.sid=n.config.sid,n.localDescription=i,u.jingle=i}n.enableChromeNativeSimulcast&&(u.jingle||(u.jingle=a.toSessionJSON(e.sdp,{role:n._role(),direction:"outgoing"})),u.jingle.contents[1].description.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),u.sdp=a.toSessionSDP(u.jingle,{sid:n.sdpSessionID,role:n._role(),direction:"outgoing"})),u.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkLocalCandidate(e)}),n.assumeSetLocalSuccess||(n.emit("answer",u),t(null,u))},function(e){n.emit("error",e),t(e)})},function(e){n.emit("error",e),t(e)},e),void 0)},n.prototype._onIce=function(e){var t=this;if(e.candidate){if(this.dontSignalCandidates)return;var n=e.candidate,i={candidate:{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex}};this._checkLocalCandidate(n.candidate);var o,c,s=a.toCandidateJSON(n.candidate);if(this.eliminateDuplicateCandidates&&"relay"===s.type&&(o=this._candidateBuffer.filter(function(e){return"relay"===e.type}).map(function(e){return e.foundation+":"+e.component}),c=o.indexOf(s.foundation+":"+s.component),c>-1&&s.priority>>24>=o[c].priority>>24))return;if("max-bundle"===this.config.bundlePolicy&&(o=this._candidateBuffer.filter(function(e){return s.type===e.type}).map(function(e){return e.address+":"+e.port}),c=o.indexOf(s.address+":"+s.port),c>-1))return;if("require"===this.config.rtcpMuxPolicy&&"2"===s.component)return;if(this._candidateBuffer.push(s),t.config.useJingle){if(n.sdpMid||(n.sdpMid=t.pc.remoteDescription&&"offer"===t.pc.remoteDescription.type?t.remoteDescription.contents[n.sdpMLineIndex].name:t.localDescription.contents[n.sdpMLineIndex].name),!t.config.ice[n.sdpMid]){var u=a.toSessionJSON(t.pc.localDescription.sdp,{role:t._role(),direction:"outgoing"});r(u.contents,function(e){var n=e.transport||{};n.ufrag&&(t.config.ice[e.name]={ufrag:n.ufrag,pwd:n.pwd})})}if(i.jingle={contents:[{name:n.sdpMid,creator:t._role(),transport:{transType:"iceUdp",ufrag:t.config.ice[n.sdpMid].ufrag,pwd:t.config.ice[n.sdpMid].pwd,candidates:[s]}}]},t.batchIceCandidates>0)return 0===t.batchedIceCandidates.length&&window.setTimeout(function(){var e={};t.batchedIceCandidates.forEach(function(t){t=t.contents[0],e[t.name]||(e[t.name]=t),e[t.name].transport.candidates.push(t.transport.candidates[0])});var n={jingle:{contents:[]}};Object.keys(e).forEach(function(t){n.jingle.contents.push(e[t])}),t.batchedIceCandidates=[],t.emit("ice",n)},t.batchIceCandidates),t.batchedIceCandidates.push(i.jingle),void 0}this.emit("ice",i)}else this.emit("endOfCandidates")},n.prototype._onDataChannel=function(e){var t=e.channel;this._remoteDataChannels.push(t),this.emit("addChannel",t)},n.prototype.createDataChannel=function(e,t){var n=this.pc.createDataChannel(e,t);return this._localDataChannels.push(n),n},n.prototype.getStats=function(e){this.pc.getStats(null,function(t){e(null,t)},function(t){e(t)})},t.exports=n},{"lodash.foreach":25,"lodash.pluck":23,"sdp-jingle-json":24,traceablepeerconnection:22,util:8,"webrtc-adapter-test":21,wildemitter:2}],18:[function(e,t){e("webrtc-adapter-test"),t.exports=function(e,t){var n,i=2===arguments.length,r={video:!0,audio:!0},o="PermissionDeniedError",a="PERMISSION_DENIED",c="ConstraintNotSatisfiedError";return i||(t=e,e=r),navigator.getUserMedia?e.audio||e.video?(localStorage&&"true"===localStorage.useFirefoxFakeDevice&&(e.fake=!0),navigator.getUserMedia(e,function(e){t(null,e)},function(e){var n;"string"==typeof e?(n=new Error("MediaStreamError"),n.name=e===o||e===a?o:c):(n=e,n.name||(e.name=n[o]?o:c)),t(n)}),void 0):(n=new Error("MediaStreamError"),n.name="NoMediaRequestedError",window.setTimeout(function(){t(n)},0)):(n=new Error("MediaStreamError"),n.name="NotSupportedError",window.setTimeout(function(){t(n)},0))}},{"webrtc-adapter-test":26}],26:[function(t,n){"use strict";function i(e){return new Promise(function(t,n){r(e,t,n)})}var r=null,o=null,a=null,c=null,s=null,u=null,d={log:function(){"undefined"!=typeof n||"function"==typeof t&&"function"==typeof e||console.log.apply(console,arguments)},extractVersion:function(e,t,n){var i=e.match(t);return i&&i.length>=n&&parseInt(i[n])}};if("object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return"mozSrcObject"in this?this.mozSrcObject:this._srcObject
},set:function(e){"mozSrcObject"in this?this.mozSrcObject=e:(this._srcObject=e,this.src=URL.createObjectURL(e))}}),r=window.navigator&&window.navigator.getUserMedia),o=function(e,t){e.srcObject=t},a=function(e,t){e.srcObject=t.srcObject},"undefined"!=typeof window&&window.navigator)if(navigator.mozGetUserMedia&&window.mozRTCPeerConnection){if(d.log("This appears to be Firefox"),c="firefox",s=d.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1),u=31,window.RTCPeerConnection=function(e,t){if(38>s&&e&&e.iceServers){for(var n=[],i=0;i<e.iceServers.length;i++){var r=e.iceServers[i];if(r.hasOwnProperty("urls"))for(var o=0;o<r.urls.length;o++){var a={url:r.urls[o]};0===r.urls[o].indexOf("turn")&&(a.username=r.username,a.credential=r.credential),n.push(a)}else n.push(e.iceServers[i])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCSessionDescription||(window.RTCSessionDescription=mozRTCSessionDescription),window.RTCIceCandidate||(window.RTCIceCandidate=mozRTCIceCandidate),r=function(e,t,n){var i=function(e){if("object"!=typeof e||e.require)return e;var t=[];return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i=e[n]="object"==typeof e[n]?e[n]:{ideal:e[n]};if((void 0!==i.min||void 0!==i.max||void 0!==i.exact)&&t.push(n),void 0!==i.exact&&("number"==typeof i.exact?i.min=i.max=i.exact:e[n]=i.exact,delete i.exact),void 0!==i.ideal){e.advanced=e.advanced||[];var r={};r[n]="number"==typeof i.ideal?{min:i.ideal,max:i.ideal}:i.ideal,e.advanced.push(r),delete i.ideal,Object.keys(i).length||delete e[n]}}}),t.length&&(e.require=t),e};return 38>s&&(d.log("spec: "+JSON.stringify(e)),e.audio&&(e.audio=i(e.audio)),e.video&&(e.video=i(e.video)),d.log("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,t,n)},navigator.getUserMedia=r,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:i,addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})},41>s){var l=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return l().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}}else if(navigator.webkitGetUserMedia&&window.webkitRTCPeerConnection){d.log("This appears to be Chrome"),c="chrome",s=d.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2),u=38,window.RTCPeerConnection=function(e,t){e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=new webkitRTCPeerConnection(e,t),i=n.getStats.bind(n);return n.getStats=function(e,t){var n=this,r=arguments;if(arguments.length>0&&"function"==typeof e)return i(e,t);var o=function(e){var t={},n=e.result();return n.forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t};if(arguments.length>=2){var a=function(e){r[1](o(e))};return i.apply(this,[a,arguments[0]])}return new Promise(function(t,a){1===r.length&&null===e?i.apply(n,[function(e){t.apply(null,[o(e)])},a]):i.apply(n,[t,a])})},n},["createOffer","createAnswer"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var n=1===arguments.length?arguments[0]:void 0;return new Promise(function(i,r){t.apply(e,[i,r,n])})}return t.apply(this,arguments)}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var e=arguments,n=this;return new Promise(function(i,r){t.apply(n,[e[0],function(){i(),e.length>=2&&e[1].apply(null,[])},function(t){r(t),e.length>=3&&e[2].apply(null,[t])}])})}});var f=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var i="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"==typeof i.exact&&(i.min=i.max=i.exact);var r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];var o={};"number"==typeof i.ideal?(o[r("min",n)]=i.ideal,t.optional.push(o),o={},o[r("max",n)]=i.ideal,t.optional.push(o)):(o[r("",n)]=i.ideal,t.optional.push(o))}void 0!==i.exact&&"number"!=typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach(function(e){void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t};if(r=function(e,t,n){return e.audio&&(e.audio=f(e.audio)),e.video&&(e.video=f(e.video)),d.log("chrome: "+JSON.stringify(e)),navigator.webkitGetUserMedia(e,t,n)},navigator.getUserMedia=r,navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:i,enumerateDevices:function(){return new Promise(function(e){var t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(n){e(n.map(function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var p=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return d.log("spec:   "+JSON.stringify(e)),e.audio=f(e.audio),e.video=f(e.video),d.log("chrome: "+JSON.stringify(e)),p(e)}}else navigator.mediaDevices.getUserMedia=function(e){return i(e)};"undefined"==typeof navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){d.log("Dummy mediaDevices.addEventListener called.")}),"undefined"==typeof navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){d.log("Dummy mediaDevices.removeEventListener called.")}),o=function(e,t){s>=43?e.srcObject=t:"undefined"!=typeof e.src?e.src=URL.createObjectURL(t):d.log("Error attaching stream to element.")},a=function(e,t){s>=43?e.srcObject=t.srcObject:e.src=t.src}}else navigator.mediaDevices&&navigator.userAgent.match(/Edge\/(\d+).(\d+)$/)?(d.log("This appears to be Edge"),c="edge",s=d.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2),u=12):d.log("Browser does not appear to be WebRTC-capable");else d.log("This does not appear to be a browser"),c="not a browser";var h={};try{Object.defineProperty(h,"version",{set:function(e){s=e}})}catch(m){}if("undefined"!=typeof n){var g;"undefined"!=typeof window&&(g=window.RTCPeerConnection),n.exports={RTCPeerConnection:g,getUserMedia:r,attachMediaStream:o,reattachMediaStream:a,webrtcDetectedBrowser:c,webrtcDetectedVersion:s,webrtcMinimumVersion:u,webrtcTesting:h,webrtcUtils:d}}else"function"==typeof t&&"function"==typeof e&&e([],function(){return{RTCPeerConnection:window.RTCPeerConnection,getUserMedia:r,attachMediaStream:o,reattachMediaStream:a,webrtcDetectedBrowser:c,webrtcDetectedVersion:s,webrtcMinimumVersion:u,webrtcTesting:h,webrtcUtils:d}})},{}],20:[function(e,t){var n=e("getusermedia"),i={};t.exports=function(e,t){var r,o=2===arguments.length,a=o?t:e;if("undefined"==typeof window||"http:"===window.location.protocol)return r=new Error("NavigatorUserMediaError"),r.name="HTTPS_REQUIRED",a(r);if(window.navigator.userAgent.match("Chrome")){var c=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),s=33,u=!window.chrome.webstore;if(window.navigator.userAgent.match("Linux")&&(s=35),sessionStorage.getScreenMediaJSExtensionId)chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(t){if(t&&""!==t.sourceId)e=o&&e||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},e.video.mandatory.chromeMediaSourceId=t.sourceId,n(e,a);else{var i=new Error("NavigatorUserMediaError");i.name="PERMISSION_DENIED",a(i)}});else if(window.cefGetScreenMedia)window.cefGetScreenMedia(function(t){if(t)e=o&&e||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},e.video.mandatory.chromeMediaSourceId=t,n(e,a);else{var i=new Error("cefGetScreenMediaError");i.name="CEF_GETSCREENMEDIA_CANCELED",a(i)}});else if(u||c>=26&&s>=c)e=o&&e||{video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},n(e,a);else{var d=window.setTimeout(function(){return r=new Error("NavigatorUserMediaError"),r.name="EXTENSION_UNAVAILABLE",a(r)},1e3);i[d]=[a,o?e:null],window.postMessage({type:"getScreen",id:d},"*")}}else if(window.navigator.userAgent.match("Firefox")){var l=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10);l>=33?(e=o&&e||{video:{mozMediaSource:"window",mediaSource:"window"}},n(e,function(e,t){if(a(e,t),!e)var n=t.currentTime,i=window.setInterval(function(){t||window.clearInterval(i),t.currentTime==n&&(window.clearInterval(i),t.onended&&t.onended()),n=t.currentTime},500)})):(r=new Error("NavigatorUserMediaError"),r.name="EXTENSION_UNAVAILABLE")}},window.addEventListener("message",function(e){if(e.origin==window.location.origin)if("gotScreen"==e.data.type&&i[e.data.id]){var t=i[e.data.id],r=t[1],o=t[0];if(delete i[e.data.id],""===e.data.sourceId){var a=new Error("NavigatorUserMediaError");a.name="PERMISSION_DENIED",o(a)}else r=r||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},r.video.mandatory.chromeMediaSourceId=e.data.sourceId,n(r,o)}else"getScreenPending"==e.data.type&&window.clearTimeout(e.data.id)})},{getusermedia:18}],19:[function(e,t){function n(e){if(this.support=i.webAudio&&i.mediaStream,this.gain=1,this.support){var t=this.context=new i.AudioContext;this.microphone=t.createMediaStreamSource(e),this.gainFilter=t.createGain(),this.destination=t.createMediaStreamDestination(),this.outputStream=this.destination.stream,this.microphone.connect(this.gainFilter),this.gainFilter.connect(this.destination),e.addTrack(this.outputStream.getAudioTracks()[0]),e.removeTrack(e.getAudioTracks()[0])}this.stream=e}var i=e("webrtcsupport");n.prototype.setGain=function(e){this.support&&(this.gainFilter.gain.value=e,this.gain=e)},n.prototype.getGain=function(){return this.gain},n.prototype.off=function(){return this.setGain(0)},n.prototype.on=function(){this.setGain(1)},t.exports=n},{webrtcsupport:16}],24:[function(e,t,n){var i=e("./lib/tosdp"),r=e("./lib/tojson");n.toIncomingSDPOffer=function(e){return i.toSessionSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingSDPOffer=function(e){return i.toSessionSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingSDPAnswer=function(e){return i.toSessionSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingSDPAnswer=function(e){return i.toSessionSDP(e,{role:"responder",direction:"outgoing"})},n.toIncomingMediaSDPOffer=function(e){return i.toMediaSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingMediaSDPOffer=function(e){return i.toMediaSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingMediaSDPAnswer=function(e){return i.toMediaSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingMediaSDPAnswer=function(e){return i.toMediaSDP(e,{role:"responder",direction:"outgoing"})},n.toCandidateSDP=i.toCandidateSDP,n.toMediaSDP=i.toMediaSDP,n.toSessionSDP=i.toSessionSDP,n.toIncomingJSONOffer=function(e,t){return r.toSessionJSON(e,{role:"responder",direction:"incoming",creators:t})},n.toOutgoingJSONOffer=function(e,t){return r.toSessionJSON(e,{role:"initiator",direction:"outgoing",creators:t})},n.toIncomingJSONAnswer=function(e,t){return r.toSessionJSON(e,{role:"initiator",direction:"incoming",creators:t})},n.toOutgoingJSONAnswer=function(e,t){return r.toSessionJSON(e,{role:"responder",direction:"outgoing",creators:t})},n.toIncomingMediaJSONOffer=function(e,t){return r.toMediaJSON(e,{role:"responder",direction:"incoming",creator:t})},n.toOutgoingMediaJSONOffer=function(e,t){return r.toMediaJSON(e,{role:"initiator",direction:"outgoing",creator:t})},n.toIncomingMediaJSONAnswer=function(e,t){return r.toMediaJSON(e,{role:"initiator",direction:"incoming",creator:t})},n.toOutgoingMediaJSONAnswer=function(e,t){return r.toMediaJSON(e,{role:"responder",direction:"outgoing",creator:t})},n.toCandidateJSON=r.toCandidateJSON,n.toMediaJSON=r.toMediaJSON,n.toSessionJSON=r.toSessionJSON},{"./lib/tojson":28,"./lib/tosdp":27}],17:[function(e,t){function n(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var i=4,r=t.length;r>i;i++)t[i]>n&&t[i]<0&&(n=t[i]);return n}var i=e("wildemitter"),r=window.AudioContext||window.webkitAudioContext,o=null;t.exports=function(e,t){var a=new i;if(!r)return a;var t=t||{},c=t.smoothing||.1,s=t.interval||50,u=t.threshold,d=t.play,l=t.history||10,f=!0;o||(o=new r);var p,h,m;m=o.createAnalyser(),m.fftSize=512,m.smoothingTimeConstant=c,h=new Float32Array(m.fftSize),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(p=o.createMediaElementSource(e),"undefined"==typeof d&&(d=!0),u=u||-50):(p=o.createMediaStreamSource(e),u=u||-50),p.connect(m),d&&m.connect(o.destination),a.speaking=!1,a.setThreshold=function(e){u=e},a.setInterval=function(e){s=e},a.stop=function(){f=!1,a.emit("volume_change",-100,u),a.speaking&&(a.speaking=!1,a.emit("stopped_speaking"))},a.speakingHistory=[];for(var g=0;l>g;g++)a.speakingHistory.push(0);var v=function(){setTimeout(function(){if(f){var e=n(m,h);a.emit("volume_change",e,u);var t=0;if(e>u&&!a.speaking){for(var i=a.speakingHistory.length-3;i<a.speakingHistory.length;i++)t+=a.speakingHistory[i];t>=2&&(a.speaking=!0,a.emit("speaking"))}else if(u>e&&a.speaking){for(var i=0;i<a.speakingHistory.length;i++)t+=a.speakingHistory[i];0==t&&(a.speaking=!1,a.emit("stopped_speaking"))}a.speakingHistory.shift(),a.speakingHistory.push(0+(e>u)),v()}},s)};return v(),a}},{wildemitter:2}],23:[function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}function i(e){var t=e+"";return e=d(e),function(n){return u(n,e,t)}}function r(e,t){var n=typeof e;if("string"==n&&h.test(e)||"number"==n)return!0;if(l(e))return!1;var i=!p.test(e);return i||null!=t&&e in o(t)}function o(e){return c(e)?e:Object(e)}function a(e,t){return f(e,s(t))}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function s(e){return r(e)?n(e):i(e)}var u=e("lodash._baseget"),d=e("lodash._topath"),l=e("lodash.isarray"),f=e("lodash.map"),p=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,h=/^\w*$/;t.exports=a},{"lodash._baseget":29,"lodash._topath":31,"lodash.isarray":30,"lodash.map":32}],25:[function(e,t){function n(e,t){return function(n,i,r){return"function"==typeof i&&void 0===r&&a(n)?e(n,i):t(n,o(i,r,3))}}var i=e("lodash._arrayeach"),r=e("lodash._baseeach"),o=e("lodash._bindcallback"),a=e("lodash.isarray"),c=n(i,r);t.exports=c},{"lodash._arrayeach":33,"lodash._baseeach":35,"lodash._bindcallback":34,"lodash.isarray":36}],30:[function(e,t){function n(e){return!!e&&"object"==typeof e}function i(e,t){var n=null==e?void 0:e[t];return c(n)?n:void 0}function r(e){return"number"==typeof e&&e>-1&&0==e%1&&v>=e}function o(e){return a(e)&&h.call(e)==u}function a(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function c(e){return null==e?!1:o(e)?m.test(f.call(e)):n(e)&&d.test(e)}var s="[object Array]",u="[object Function]",d=/^\[object .+?Constructor\]$/,l=Object.prototype,f=Function.prototype.toString,p=l.hasOwnProperty,h=l.toString,m=RegExp("^"+f.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=i(Array,"isArray"),v=9007199254740991,y=g||function(e){return n(e)&&r(e.length)&&h.call(e)==s};t.exports=y},{}],29:[function(e,t){function n(e,t,n){if(null!=e){void 0!==n&&n in i(e)&&(t=[n]);for(var r=0,o=t.length;null!=e&&o>r;)e=e[t[r++]];return r&&r==o?e:void 0}}function i(e){return r(e)?e:Object(e)}function r(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}t.exports=n},{}],27:[function(e,t,n){var i=e("./senders");n.toSessionSDP=function(e,t){t.role||"initiator",t.direction||"outgoing";var i=t.sid||e.sid||Date.now(),r=t.time||Date.now(),o=["v=0","o=- "+i+" "+r+" IN IP4 0.0.0.0","s=-","t=0 0","a=msid-semantic: WMS *"],a=e.groups||[];a.forEach(function(e){o.push("a=group:"+e.semantics+" "+e.contents.join(" "))});var c=e.contents||[];return c.forEach(function(e){o.push(n.toMediaSDP(e,t))}),o.join("\r\n")+"\r\n"},n.toMediaSDP=function(e,t){var r=[],o=t.role||"initiator",a=t.direction||"outgoing",c=e.description,s=e.transport,u=c.payloads||[],d=s&&s.fingerprints||[],l=[];if("datachannel"==c.descType?(l.push("application"),l.push("1"),l.push("DTLS/SCTP"),s.sctp&&s.sctp.forEach(function(e){l.push(e.number)})):(l.push(c.media),l.push("1"),c.encryption&&c.encryption.length>0||d.length>0?l.push("RTP/SAVPF"):l.push("RTP/AVPF"),u.forEach(function(e){l.push(e.id)})),r.push("m="+l.join(" ")),r.push("c=IN IP4 0.0.0.0"),c.bandwidth&&c.bandwidth.type&&c.bandwidth.bandwidth&&r.push("b="+c.bandwidth.type+":"+c.bandwidth.bandwidth),"rtp"==c.descType&&r.push("a=rtcp:1 IN IP4 0.0.0.0"),s){s.ufrag&&r.push("a=ice-ufrag:"+s.ufrag),s.pwd&&r.push("a=ice-pwd:"+s.pwd);var f=!1;d.forEach(function(e){r.push("a=fingerprint:"+e.hash+" "+e.value),e.setup&&!f&&r.push("a=setup:"+e.setup)}),s.sctp&&s.sctp.forEach(function(e){r.push("a=sctpmap:"+e.number+" "+e.protocol+" "+e.streams)})}"rtp"==c.descType&&r.push("a="+(i[o][a][e.senders]||"sendrecv")),r.push("a=mid:"+e.name),c.sources&&c.sources.length&&(c.sources[0].parameters||[]).forEach(function(e){"msid"===e.key&&r.push("a=msid:"+e.value)}),c.mux&&r.push("a=rtcp-mux");var p=c.encryption||[];p.forEach(function(e){r.push("a=crypto:"+e.tag+" "+e.cipherSuite+" "+e.keyParams+(e.sessionParams?" "+e.sessionParams:""))}),c.googConferenceFlag&&r.push("a=x-google-flag:conference"),u.forEach(function(e){var t="a=rtpmap:"+e.id+" "+e.name+"/"+e.clockrate;if(e.channels&&"1"!=e.channels&&(t+="/"+e.channels),r.push(t),e.parameters&&e.parameters.length){var n=["a=fmtp:"+e.id],i=[];e.parameters.forEach(function(e){i.push((e.key?e.key+"=":"")+e.value)}),n.push(i.join(";")),r.push(n.join(" "))}e.feedback&&e.feedback.forEach(function(t){"trr-int"===t.type?r.push("a=rtcp-fb:"+e.id+" trr-int "+(t.value?t.value:"0")):r.push("a=rtcp-fb:"+e.id+" "+t.type+(t.subtype?" "+t.subtype:""))})}),c.feedback&&c.feedback.forEach(function(e){"trr-int"===e.type?r.push("a=rtcp-fb:* trr-int "+(e.value?e.value:"0")):r.push("a=rtcp-fb:* "+e.type+(e.subtype?" "+e.subtype:""))});var h=c.headerExtensions||[];h.forEach(function(e){r.push("a=extmap:"+e.id+(e.senders?"/"+i[o][a][e.senders]:"")+" "+e.uri)});var m=c.sourceGroups||[];m.forEach(function(e){r.push("a=ssrc-group:"+e.semantics+" "+e.sources.join(" "))});var g=c.sources||[];g.forEach(function(e){for(var t=0;t<e.parameters.length;t++){var n=e.parameters[t];r.push("a=ssrc:"+(e.ssrc||c.ssrc)+" "+n.key+(n.value?":"+n.value:""))}});var v=s.candidates||[];return v.forEach(function(e){r.push(n.toCandidateSDP(e))}),r.join("\r\n")},n.toCandidateSDP=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),("srflx"===n||"prflx"===n||"relay"===n)&&e.relAddr&&e.relPort&&(t.push("raddr"),t.push(e.relAddr),t.push("rport"),t.push(e.relPort)),e.tcpType&&"TCP"==e.protocol.toUpperCase()&&(t.push("tcptype"),t.push(e.tcpType)),t.push("generation"),t.push(e.generation||"0"),"a=candidate:"+t.join(" ")}},{"./senders":37}],33:[function(e,t){function n(e,t){for(var n=-1,i=e.length;++n<i&&t(e[n],n,e)!==!1;);return e}t.exports=n},{}],28:[function(e,t,n){var i=e("./senders"),r=e("./parsers"),o=Math.random();n._setIdCounter=function(e){o=e},n.toSessionJSON=function(e,t){var i,o=t.creators||[],a=t.role||"initiator",c=t.direction||"outgoing",s=e.split("\r\nm=");for(i=1;i<s.length;i++)s[i]="m="+s[i],i!==s.length-1&&(s[i]+="\r\n");var u=s.shift()+"\r\n",d=r.lines(u),l={},f=[];for(i=0;i<s.length;i++)f.push(n.toMediaJSON(s[i],u,{role:a,direction:c,creator:o[i]||"initiator"}));l.contents=f;var p=r.findLines("a=group:",d);return p.length&&(l.groups=r.groups(p)),l},n.toMediaJSON=function(e,t,o){var a=o.creator||"initiator",c=o.role||"initiator",s=o.direction||"outgoing",u=r.lines(e),d=r.lines(t),l=r.mline(u[0]),f={creator:a,name:l.media,description:{descType:"rtp",media:l.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transType:"iceUdp",candidates:[],fingerprints:[]}};"application"==l.media&&(f.description={descType:"datachannel"},f.transport.sctp=[]);var p=f.description,h=f.transport,m=r.findLine("a=mid:",u);if(m&&(f.name=m.substr(6)),r.findLine("a=sendrecv",u,d)?f.senders="both":r.findLine("a=sendonly",u,d)?f.senders=i[c][s].sendonly:r.findLine("a=recvonly",u,d)?f.senders=i[c][s].recvonly:r.findLine("a=inactive",u,d)&&(f.senders="none"),"rtp"==p.descType){var g=r.findLine("b=",u);g&&(p.bandwidth=r.bandwidth(g));var v=r.findLine("a=ssrc:",u);v&&(p.ssrc=v.substr(7).split(" ")[0]);var y=r.findLines("a=rtpmap:",u);y.forEach(function(e){var t=r.rtpmap(e);t.parameters=[],t.feedback=[];var n=r.findLines("a=fmtp:"+t.id,u);n.forEach(function(e){t.parameters=r.fmtp(e)});var i=r.findLines("a=rtcp-fb:"+t.id,u);i.forEach(function(e){t.feedback.push(r.rtcpfb(e))}),p.payloads.push(t)});var b=r.findLines("a=crypto:",u,d);b.forEach(function(e){p.encryption.push(r.crypto(e))}),r.findLine("a=rtcp-mux",u)&&(p.mux=!0);var w=r.findLines("a=rtcp-fb:*",u);w.forEach(function(e){p.feedback.push(r.rtcpfb(e))});var S=r.findLines("a=extmap:",u);S.forEach(function(e){var t=r.extmap(e);t.senders=i[c][s][t.senders],p.headerExtensions.push(t)});var C=r.findLines("a=ssrc-group:",u);p.sourceGroups=r.sourceGroups(C||[]);var E=r.findLines("a=ssrc:",u),D=p.sources=r.sources(E||[]),O=r.findLine("a=msid:",u);if(O){var j=r.msid(O);["msid","mslabel","label"].forEach(function(e){for(var t=0;t<D.length;t++){for(var n=!1,i=0;i<D[t].parameters.length;i++)D[t].parameters[i].key===e&&(n=!0);n||D[t].parameters.push({key:e,value:j[e]})}})}r.findLine("a=x-google-flag:conference",u,d)&&(p.googConferenceFlag=!0)}var k=r.findLines("a=fingerprint:",u,d),x=r.findLine("a=setup:",u,d);k.forEach(function(e){var t=r.fingerprint(e);x&&(t.setup=x.substr(8)),h.fingerprints.push(t)});var M=r.findLine("a=ice-ufrag:",u,d),T=r.findLine("a=ice-pwd:",u,d);if(M&&T){h.ufrag=M.substr(12),h.pwd=T.substr(10),h.candidates=[];var R=r.findLines("a=candidate:",u,d);R.forEach(function(e){h.candidates.push(n.toCandidateJSON(e))})}if("datachannel"==p.descType){var P=r.findLines("a=sctpmap:",u);P.forEach(function(e){var t=r.sctpmap(e);h.sctp.push(t)})}return f},n.toCandidateJSON=function(e){var t=r.candidate(e.split("\r\n")[0]);return t.id=(o++).toString(36).substr(0,12),t}},{"./parsers":38,"./senders":37}],34:[function(e,t){function n(e,t,n){if("function"!=typeof e)return i;if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)};case 5:return function(n,i,r,o,a){return e.call(t,n,i,r,o,a)}}return function(){return e.apply(t,arguments)}}function i(e){return e}t.exports=n},{}],36:[function(e,t){function n(e){return!!e&&"object"==typeof e}function i(e,t){var n=null==e?void 0:e[t];return c(n)?n:void 0}function r(e){return"number"==typeof e&&e>-1&&0==e%1&&v>=e}function o(e){return a(e)&&h.call(e)==u}function a(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function c(e){return null==e?!1:o(e)?m.test(f.call(e)):n(e)&&d.test(e)}var s="[object Array]",u="[object Function]",d=/^\[object .+?Constructor\]$/,l=Object.prototype,f=Function.prototype.toString,p=l.hasOwnProperty,h=l.toString,m=RegExp("^"+f.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),g=i(Array,"isArray"),v=9007199254740991,y=g||function(e){return n(e)&&r(e.length)&&h.call(e)==s};t.exports=y},{}],37:[function(e,t){t.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],38:[function(e,t,n){n.lines=function(e){return e.split("\r\n").filter(function(e){return e.length>0})},n.findLine=function(e,t,n){for(var i=e.length,r=0;r<t.length;r++)if(t[r].substr(0,i)===e)return t[r];if(!n)return!1;for(var o=0;o<n.length;o++)if(n[o].substr(0,i)===e)return n[o];return!1},n.findLines=function(e,t,n){for(var i=[],r=e.length,o=0;o<t.length;o++)t[o].substr(0,r)===e&&i.push(t[o]);if(i.length||!n)return i;for(var a=0;a<n.length;a++)n[a].substr(0,r)===e&&i.push(n[a]);return i},n.mline=function(e){for(var t=e.substr(2).split(" "),n={media:t[0],port:t[1],proto:t[2],formats:[]},i=3;i<t.length;i++)t[i]&&n.formats.push(t[i]);return n},n.rtpmap=function(e){var t=e.substr(9).split(" "),n={id:t.shift()};return t=t[0].split("/"),n.name=t[0],n.clockrate=t[1],n.channels=3==t.length?t[2]:"1",n},n.sctpmap=function(e){var t=e.substr(10).split(" "),n={number:t.shift(),protocol:t.shift(),streams:t.shift()};return n},n.fmtp=function(e){for(var t,n,i,r=e.substr(e.indexOf(" ")+1).split(";"),o=[],a=0;a<r.length;a++)t=r[a].split("="),n=t[0].trim(),i=t[1],n&&i?o.push({key:n,value:i}):n&&o.push({key:"",value:n});return o},n.crypto=function(e){var t=e.substr(9).split(" "),n={tag:t[0],cipherSuite:t[1],keyParams:t[2],sessionParams:t.slice(3).join(" ")};return n},n.fingerprint=function(e){var t=e.substr(14).split(" ");return{hash:t[0],value:t[1]}},n.extmap=function(e){var t=e.substr(9).split(" "),n={},i=t.shift(),r=i.indexOf("/");return r>=0?(n.id=i.substr(0,r),n.senders=i.substr(r+1)):(n.id=i,n.senders="sendrecv"),n.uri=t.shift()||"",n},n.rtcpfb=function(e){var t=e.substr(10).split(" "),n={};return n.id=t.shift(),n.type=t.shift(),"trr-int"===n.type?n.value=t.shift():n.subtype=t.shift()||"",n.parameters=t,n},n.candidate=function(e){var t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");for(var n={foundation:t[0],component:t[1],protocol:t[2].toLowerCase(),priority:t[3],ip:t[4],port:t[5],type:t[7],generation:"0"},i=8;i<t.length;i+=2)"raddr"===t[i]?n.relAddr=t[i+1]:"rport"===t[i]?n.relPort=t[i+1]:"generation"===t[i]?n.generation=t[i+1]:"tcptype"===t[i]&&(n.tcpType=t[i+1]);return n.network="1",n},n.sourceGroups=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n].substr(13).split(" ");t.push({semantics:i.shift(),sources:i})}return t},n.sources=function(e){for(var t=[],n={},i=0;i<e.length;i++){var r=e[i].substr(7).split(" "),o=r.shift();if(!n[o]){var a={ssrc:o,parameters:[]};t.push(a),n[o]=a}r=r.join(" ").split(":");var c=r.shift(),s=r.join(":")||null;n[o].parameters.push({key:c,value:s})}return t},n.groups=function(e){for(var t,n=[],i=0;i<e.length;i++)t=e[i].substr(8).split(" "),n.push({semantics:t.shift(),contents:t});return n},n.bandwidth=function(e){var t=e.substr(2).split(":"),n={};return n.type=t.shift(),n.bandwidth=t.shift(),n},n.msid=function(e){var t=e.substr(7),n=t.split(" ");return{msid:t,mslabel:n[0],label:n[1]}}},{}],22:[function(e,t){function n(e){return{type:e.type,sdp:e.sdp}}function i(e){var t={label:e.id};return e.getAudioTracks().length&&(t.audio=e.getAudioTracks().map(function(e){return e.id})),e.getVideoTracks().length&&(t.video=e.getVideoTracks().map(function(e){return e.id})),t}function r(e,t){var n=this;a.call(this),this.peerconnection=new window.RTCPeerConnection(e,t),this.trace=function(e,t){n.emit("PeerConnectionTrace",{time:new Date,type:e,value:t||""})},this.onicecandidate=null,this.peerconnection.onicecandidate=function(e){n.trace("onicecandidate",e.candidate),null!==n.onicecandidate&&n.onicecandidate(e)},this.onaddstream=null,this.peerconnection.onaddstream=function(e){n.trace("onaddstream",i(e.stream)),null!==n.onaddstream&&n.onaddstream(e)},this.onremovestream=null,this.peerconnection.onremovestream=function(e){n.trace("onremovestream",i(e.stream)),null!==n.onremovestream&&n.onremovestream(e)},this.onsignalingstatechange=null,this.peerconnection.onsignalingstatechange=function(e){n.trace("onsignalingstatechange",n.signalingState),null!==n.onsignalingstatechange&&n.onsignalingstatechange(e)},this.oniceconnectionstatechange=null,this.peerconnection.oniceconnectionstatechange=function(e){n.trace("oniceconnectionstatechange",n.iceConnectionState),null!==n.oniceconnectionstatechange&&n.oniceconnectionstatechange(e)},this.onnegotiationneeded=null,this.peerconnection.onnegotiationneeded=function(e){n.trace("onnegotiationneeded"),null!==n.onnegotiationneeded&&n.onnegotiationneeded(e)},n.ondatachannel=null,this.peerconnection.ondatachannel=function(e){n.trace("ondatachannel",e),null!==n.ondatachannel&&n.ondatachannel(e)},this.getLocalStreams=this.peerconnection.getLocalStreams.bind(this.peerconnection),this.getRemoteStreams=this.peerconnection.getRemoteStreams.bind(this.peerconnection)}var o=e("util");e("webrtc-adapter-test");var a=e("wildemitter");o.inherits(r,a),["signalingState","iceConnectionState","localDescription","remoteDescription"].forEach(function(e){Object.defineProperty(r.prototype,e,{get:function(){return this.peerconnection[e]}})}),r.prototype.addStream=function(e){this.trace("addStream",i(e)),this.peerconnection.addStream(e)},r.prototype.removeStream=function(e){this.trace("removeStream",i(e)),this.peerconnection.removeStream(e)},r.prototype.createDataChannel=function(e,t){return this.trace("createDataChannel",e,t),this.peerconnection.createDataChannel(e,t)},r.prototype.setLocalDescription=function(e,t,i){var r=this;this.trace("setLocalDescription",n(e)),this.peerconnection.setLocalDescription(e,function(){r.trace("setLocalDescriptionOnSuccess"),t&&t()},function(e){r.trace("setLocalDescriptionOnFailure",e),i&&i(e)})},r.prototype.setRemoteDescription=function(e,t,i){var r=this;this.trace("setRemoteDescription",n(e)),this.peerconnection.setRemoteDescription(e,function(){r.trace("setRemoteDescriptionOnSuccess"),t&&t()},function(e){r.trace("setRemoteDescriptionOnFailure",e),i&&i(e)})},r.prototype.close=function(){this.trace("stop"),"closed"!=this.peerconnection.signalingState&&this.peerconnection.close()},r.prototype.createOffer=function(e,t,i){var r=this;this.trace("createOffer",i),this.peerconnection.createOffer(function(t){r.trace("createOfferOnSuccess",n(t)),e&&e(t)},function(e){r.trace("createOfferOnFailure",e),t&&t(e)},i)},r.prototype.createAnswer=function(e,t,i){var r=this;this.trace("createAnswer",i),this.peerconnection.createAnswer(function(t){r.trace("createAnswerOnSuccess",n(t)),e&&e(t)},function(e){r.trace("createAnswerOnFailure",e),t&&t(e)},i)},r.prototype.addIceCandidate=function(e,t,n){var i=this;this.trace("addIceCandidate",e),this.peerconnection.addIceCandidate(e,function(){t&&t()},function(e){i.trace("addIceCandidateOnFailure",e),n&&n(e)})},r.prototype.getStats=function(){this.peerconnection.getStats.apply(this.peerconnection,arguments)},t.exports=r},{util:8,"webrtc-adapter-test":21,wildemitter:2}],35:[function(e,t){function n(e,t){return f(e,t,u)
}function i(e){return function(t){return null==t?void 0:t[e]}}function r(e,t){return function(n,i){var r=n?p(n):0;if(!a(r))return e(n,i);for(var o=t?r:-1,s=c(n);(t?o--:++o<r)&&i(s[o],o,s)!==!1;);return n}}function o(e){return function(t,n,i){for(var r=c(t),o=i(t),a=o.length,s=e?a:-1;e?s--:++s<a;){var u=o[s];if(n(r[u],u,r)===!1)break}return t}}function a(e){return"number"==typeof e&&e>-1&&0==e%1&&d>=e}function c(e){return s(e)?e:Object(e)}function s(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var u=e("lodash.keys"),d=9007199254740991,l=r(n),f=o(),p=i("length");t.exports=l},{"lodash.keys":39}],31:[function(e,t){function n(e){return null==e?"":e+""}function i(e){if(r(e))return e;var t=[];return n(e).replace(o,function(e,n,i,r){t.push(i?r.replace(a,"$1"):n||e)}),t}var r=e("lodash.isarray"),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,a=/\\(\\)?/g;t.exports=i},{"lodash.isarray":30}],32:[function(e,t){function n(e,t){var n=-1,i=r(e)?Array(e.length):[];return u(e,function(e,r,o){i[++n]=t(e,r,o)}),i}function i(e){return function(t){return null==t?void 0:t[e]}}function r(e){return null!=e&&o(f(e))}function o(e){return"number"==typeof e&&e>-1&&0==e%1&&l>=e}function a(e,t,i){var r=d(e)?c:n;return t=s(t,i,3),r(e,t)}var c=e("lodash._arraymap"),s=e("lodash._basecallback"),u=e("lodash._baseeach"),d=e("lodash.isarray"),l=9007199254740991,f=i("length");t.exports=a},{"lodash._arraymap":40,"lodash._basecallback":42,"lodash._baseeach":41,"lodash.isarray":30}],40:[function(e,t){function n(e,t){for(var n=-1,i=e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}t.exports=n},{}],43:[function(e,t){function n(e){return!!e&&"object"==typeof e}function i(e,t){var n=null==e?void 0:e[t];return a(n)?n:void 0}function r(e){return o(e)&&f.call(e)==c}function o(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function a(e){return null==e?!1:r(e)?p.test(d.call(e)):n(e)&&s.test(e)}var c="[object Function]",s=/^\[object .+?Constructor\]$/,u=Object.prototype,d=Function.prototype.toString,l=u.hasOwnProperty,f=u.toString,p=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=i},{}],44:[function(e,t){function n(e,t,n){if("function"!=typeof e)return i;if(void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,r){return e.call(t,n,i,r)};case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)};case 5:return function(n,i,r,o,a){return e.call(t,n,i,r,o,a)}}return function(){return e.apply(t,arguments)}}function i(e){return e}t.exports=n},{}],45:[function(e,t){function n(e){return!!e&&"object"==typeof e}function i(e){return function(t){return null==t?void 0:t[e]}}function r(e){return null!=e&&o(l(e))}function o(e){return"number"==typeof e&&e>-1&&0==e%1&&d>=e}function a(e){return n(e)&&r(e)&&s.call(e,"callee")&&!u.call(e,"callee")}var c=Object.prototype,s=c.hasOwnProperty,u=c.propertyIsEnumerable,d=9007199254740991,l=i("length");t.exports=a},{}],41:[function(e,t){function n(e,t){return f(e,t,u)}function i(e){return function(t){return null==t?void 0:t[e]}}function r(e,t){return function(n,i){var r=n?p(n):0;if(!a(r))return e(n,i);for(var o=t?r:-1,s=c(n);(t?o--:++o<r)&&i(s[o],o,s)!==!1;);return n}}function o(e){return function(t,n,i){for(var r=c(t),o=i(t),a=o.length,s=e?a:-1;e?s--:++s<a;){var u=o[s];if(n(r[u],u,r)===!1)break}return t}}function a(e){return"number"==typeof e&&e>-1&&0==e%1&&d>=e}function c(e){return s(e)?e:Object(e)}function s(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var u=e("lodash.keys"),d=9007199254740991,l=r(n),f=o(),p=i("length");t.exports=l},{"lodash.keys":46}],42:[function(e,t){function n(e){return null==e?"":e+""}function i(e,t,n){var i=typeof e;return"function"==i?void 0===t?e:S(e,t,n):null==e?y:"object"==i?a(e):void 0===t?b(e):c(e,t)}function r(e,t,n){if(null!=e){void 0!==n&&n in h(e)&&(t=[n]);for(var i=0,r=t.length;null!=e&&r>i;)e=e[t[i++]];return i&&i==r?e:void 0}}function o(e,t,n){var i=t.length,r=i,o=!n;if(null==e)return!r;for(e=h(e);i--;){var a=t[i];if(o&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<r;){a=t[i];var c=a[0],s=e[c],u=a[1];if(o&&a[2]){if(void 0===s&&!(c in e))return!1}else{var d=n?n(s,u,c):void 0;if(!(void 0===d?w(u,s,n,!0):d))return!1}}return!0}function a(e){var t=l(e);if(1==t.length&&t[0][2]){var n=t[0][0],i=t[0][1];return function(e){return null==e?!1:e[n]===i&&(void 0!==i||n in h(e))}}return function(e){return o(e,t)}}function c(e,t){var n=C(e),i=f(e)&&p(t),o=e+"";return e=m(e),function(a){if(null==a)return!1;var c=o;if(a=h(a),!(!n&&i||c in a)){if(a=1==e.length?a:r(a,d(e,0,-1)),null==a)return!1;c=g(e),a=h(a)}return a[c]===t?void 0!==t||c in a:w(t,a[c],void 0,!0)}}function s(e){return function(t){return null==t?void 0:t[e]}}function u(e){var t=e+"";return e=m(e),function(n){return r(n,e,t)}}function d(e,t,n){var i=-1,r=e.length;t=null==t?0:+t||0,0>t&&(t=-t>r?0:r+t),n=void 0===n||n>r?r:+n||0,0>n&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(r);++i<r;)o[i]=e[i+t];return o}function l(e){for(var t=E(e),n=t.length;n--;)t[n][2]=p(t[n][1]);return t}function f(e,t){var n=typeof e;if("string"==n&&O.test(e)||"number"==n)return!0;if(C(e))return!1;var i=!D.test(e);return i||null!=t&&e in h(t)}function p(e){return e===e&&!v(e)}function h(e){return v(e)?e:Object(e)}function m(e){if(C(e))return e;var t=[];return n(e).replace(j,function(e,n,i,r){t.push(i?r.replace(k,"$1"):n||e)}),t}function g(e){var t=e?e.length:0;return t?e[t-1]:void 0}function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){return e}function b(e){return f(e)?s(e):u(e)}var w=e("lodash._baseisequal"),S=e("lodash._bindcallback"),C=e("lodash.isarray"),E=e("lodash.pairs"),D=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,O=/^\w*$/,j=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,k=/\\(\\)?/g;t.exports=i},{"lodash._baseisequal":47,"lodash._bindcallback":44,"lodash.isarray":30,"lodash.pairs":48}],39:[function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}function i(e){return null!=e&&o(v(e))}function r(e,t){return e="number"==typeof e||f.test(e)?+e:-1,t=null==t?g:t,e>-1&&0==e%1&&t>e}function o(e){return"number"==typeof e&&e>-1&&0==e%1&&g>=e}function a(e){for(var t=s(e),n=t.length,i=n&&e.length,a=!!i&&o(i)&&(l(e)||d(e)),c=-1,u=[];++c<n;){var f=t[c];(a&&r(f,i)||h.call(e,f))&&u.push(f)}return u}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function s(e){if(null==e)return[];c(e)||(e=Object(e));var t=e.length;t=t&&o(t)&&(l(e)||d(e))&&t||0;for(var n=e.constructor,i=-1,a="function"==typeof n&&n.prototype===e,s=Array(t),u=t>0;++i<t;)s[i]=i+"";for(var f in e)u&&r(f,t)||"constructor"==f&&(a||!h.call(e,f))||s.push(f);return s}var u=e("lodash._getnative"),d=e("lodash.isarguments"),l=e("lodash.isarray"),f=/^\d+$/,p=Object.prototype,h=p.hasOwnProperty,m=u(Object,"keys"),g=9007199254740991,v=n("length"),y=m?function(e){var t=null==e?void 0:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&i(e)?a(e):c(e)?m(e):[]}:a;t.exports=y},{"lodash._getnative":43,"lodash.isarguments":45,"lodash.isarray":36}],49:[function(e,t){function n(e){return!!e&&"object"==typeof e}function i(e){return"number"==typeof e&&e>-1&&0==e%1&&R>=e}function r(e){return n(e)&&i(e.length)&&!!x[T.call(e)]}var o="[object Arguments]",a="[object Array]",c="[object Boolean]",s="[object Date]",u="[object Error]",d="[object Function]",l="[object Map]",f="[object Number]",p="[object Object]",h="[object RegExp]",m="[object Set]",g="[object String]",v="[object WeakMap]",y="[object ArrayBuffer]",b="[object Float32Array]",w="[object Float64Array]",S="[object Int8Array]",C="[object Int16Array]",E="[object Int32Array]",D="[object Uint8Array]",O="[object Uint8ClampedArray]",j="[object Uint16Array]",k="[object Uint32Array]",x={};x[b]=x[w]=x[S]=x[C]=x[E]=x[D]=x[O]=x[j]=x[k]=!0,x[o]=x[a]=x[y]=x[c]=x[s]=x[u]=x[d]=x[l]=x[f]=x[p]=x[h]=x[m]=x[g]=x[v]=!1;var M=Object.prototype,T=M.toString,R=9007199254740991;t.exports=r},{}],50:[function(e,t){function n(e){return!!e&&"object"==typeof e}function i(e){return function(t){return null==t?void 0:t[e]}}function r(e){return null!=e&&o(l(e))}function o(e){return"number"==typeof e&&e>-1&&0==e%1&&d>=e}function a(e){return n(e)&&r(e)&&s.call(e,"callee")&&!u.call(e,"callee")}var c=Object.prototype,s=c.hasOwnProperty,u=c.propertyIsEnumerable,d=9007199254740991,l=i("length");t.exports=a},{}],51:[function(e,t){function n(e){return!!e&&"object"==typeof e}function i(e,t){var n=null==e?void 0:e[t];return a(n)?n:void 0}function r(e){return o(e)&&f.call(e)==c}function o(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function a(e){return null==e?!1:r(e)?p.test(d.call(e)):n(e)&&s.test(e)}var c="[object Function]",s=/^\[object .+?Constructor\]$/,u=Object.prototype,d=Function.prototype.toString,l=u.hasOwnProperty,f=u.toString,p=RegExp("^"+d.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=i},{}],48:[function(e,t){function n(e){return i(e)?e:Object(e)}function i(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function r(e){e=n(e);for(var t=-1,i=o(e),r=i.length,a=Array(r);++t<r;){var c=i[t];a[t]=[c,e[c]]}return a}var o=e("lodash.keys");t.exports=r},{"lodash.keys":46}],47:[function(e,t){function n(e){return!!e&&"object"==typeof e}function i(e,t){for(var n=-1,i=e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function r(e,t,i,a,c,s){return e===t?!0:null==e||null==t||!u(e)&&!n(t)?e!==e&&t!==t:o(e,t,r,i,a,c,s)}function o(e,t,n,i,r,o,u){var f=d(e),m=d(t),g=h,v=h;f||(g=D.call(e),g==p?g=b:g!=b&&(f=l(e))),m||(v=D.call(t),v==p?v=b:v!=b&&(m=l(t)));var y=g==b,w=v==b,S=g==v;if(S&&!f&&!y)return c(e,t,g);if(!r){var C=y&&E.call(e,"__wrapped__"),O=w&&E.call(t,"__wrapped__");if(C||O)return n(C?e.value():e,O?t.value():t,i,r,o,u)}if(!S)return!1;o||(o=[]),u||(u=[]);for(var j=o.length;j--;)if(o[j]==e)return u[j]==t;o.push(e),u.push(t);var k=(f?a:s)(e,t,n,i,r,o,u);return o.pop(),u.pop(),k}function a(e,t,n,r,o,a,c){var s=-1,u=e.length,d=t.length;if(u!=d&&!(o&&d>u))return!1;for(;++s<u;){var l=e[s],f=t[s],p=r?r(o?f:l,o?l:f,s):void 0;if(void 0!==p){if(p)continue;return!1}if(o){if(!i(t,function(e){return l===e||n(l,e,r,o,a,c)}))return!1}else if(l!==f&&!n(l,f,r,o,a,c))return!1}return!0}function c(e,t,n){switch(n){case m:case g:return+e==+t;case v:return e.name==t.name&&e.message==t.message;case y:return e!=+e?t!=+t:e==+t;case w:case S:return e==t+""}return!1}function s(e,t,n,i,r,o,a){var c=f(e),s=c.length,u=f(t),d=u.length;if(s!=d&&!r)return!1;for(var l=s;l--;){var p=c[l];if(!(r?p in t:E.call(t,p)))return!1}for(var h=r;++l<s;){p=c[l];var m=e[p],g=t[p],v=i?i(r?g:m,r?m:g,p):void 0;if(!(void 0===v?n(m,g,i,r,o,a):v))return!1;h||(h="constructor"==p)}if(!h){var y=e.constructor,b=t.constructor;if(y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b))return!1}return!0}function u(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}var d=e("lodash.isarray"),l=e("lodash.istypedarray"),f=e("lodash.keys"),p="[object Arguments]",h="[object Array]",m="[object Boolean]",g="[object Date]",v="[object Error]",y="[object Number]",b="[object Object]",w="[object RegExp]",S="[object String]",C=Object.prototype,E=C.hasOwnProperty,D=C.toString;t.exports=r},{"lodash.isarray":30,"lodash.istypedarray":49,"lodash.keys":46}],46:[function(e,t){function n(e){return function(t){return null==t?void 0:t[e]}}function i(e){return null!=e&&o(v(e))}function r(e,t){return e="number"==typeof e||f.test(e)?+e:-1,t=null==t?g:t,e>-1&&0==e%1&&t>e}function o(e){return"number"==typeof e&&e>-1&&0==e%1&&g>=e}function a(e){for(var t=s(e),n=t.length,i=n&&e.length,a=!!i&&o(i)&&(l(e)||d(e)),c=-1,u=[];++c<n;){var f=t[c];(a&&r(f,i)||h.call(e,f))&&u.push(f)}return u}function c(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function s(e){if(null==e)return[];c(e)||(e=Object(e));var t=e.length;t=t&&o(t)&&(l(e)||d(e))&&t||0;for(var n=e.constructor,i=-1,a="function"==typeof n&&n.prototype===e,s=Array(t),u=t>0;++i<t;)s[i]=i+"";for(var f in e)u&&r(f,t)||"constructor"==f&&(a||!h.call(e,f))||s.push(f);return s}var u=e("lodash._getnative"),d=e("lodash.isarguments"),l=e("lodash.isarray"),f=/^\d+$/,p=Object.prototype,h=p.hasOwnProperty,m=u(Object,"keys"),g=9007199254740991,v=n("length"),y=m?function(e){var t=null==e?void 0:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&i(e)?a(e):c(e)?m(e):[]}:a;t.exports=y},{"lodash._getnative":51,"lodash.isarguments":50,"lodash.isarray":30}]},{},[3])(3)});